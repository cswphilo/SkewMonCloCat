\documentclass[copyright,creativecommons]{eptcs}
\providecommand{\event}{NCL'22} % Name of the event you are submitting to
%\usepackage{breakurl}             % Not needed if you use pdflatex only.
\usepackage{underscore}           % Only needed if you use pdflatex.
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{enumerate}
%\usepackage{prftree}
%\usepackage{ntheorem}
%\usepackage{tikz-cd}
\usepackage{hyperref}
%\usepackage{float}
%\usepackage{graphicx}
\usepackage{quiver}
\usepackage[all,cmtip]{xy}
%\usepackage{bussproofs}
\usepackage{proof}
%\usepackage[a4paper, total={6in, 8in}]{geometry}
%\usepackage{lscape}
%% \theorembodyfont{}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{proposition}[theorem]{Proposition}
\theoremstyle{definition}
\newtheorem{defn}{Definition}[section]
\newtheorem{example}{Example}[section]
%\newtheorem{defn}[definition]{Definition}
%\newtheorem{example}[definition]{Definition}
%\newtheorem*{proof}{Proof : }
\newtheorem{fact}[theorem]{Fact}
\makeatletter
\newsavebox{\@brx}
\newcommand{\llangle}[1][]{\savebox{\@brx}{\(\m@th{#1\langle}\)}%
  \mathopen{\copy\@brx\kern-0.5\wd\@brx\usebox{\@brx}}}
\newcommand{\rrangle}[1][]{\savebox{\@brx}{\(\m@th{#1\rangle}\)}%
  \mathclose{\copy\@brx\kern-0.5\wd\@brx\usebox{\@brx}}}
\makeatother
\newcommand{\ldbc}{[\![}
\newcommand{\rdbc}{]\!]}
\newcommand{\tbar}{[\vec{x}/\vec{t}]}
\newcommand{\ltbar}{[\vec{x}, x/\vec{t}, x]}
\newcommand{\tl}{\otimes \mathsf{L}}
\newcommand{\tr}{\otimes \mathsf{R}}
\newcommand{\lright}{{\multimap}\mathsf{R}}
\newcommand{\lleft}{{\multimap}\mathsf{L}}
\newcommand{\pass}{\mathsf{pass}}
\newcommand{\unitl}{\mathsf{IL}}
\newcommand{\unitr}{\mathsf{IR}}
\newcommand{\ax}{\mathsf{ax}}
\newcommand{\id}{\mathsf{id}}
\newcommand{\ot}{\otimes}
\newcommand{\lolli}{\multimap}
\newcommand{\illol}{\rotatebox[origin=c]{180}{$\multimap$}}
\newcommand{\I}{\mathsf{I}}
\newcommand{\msfL}{\mathsf{L}}
\newcommand{\defeq}{=_{\mathsf{df}}}
\newcommand{\comp}{\mathsf{comp}}
\newcommand{\RI}{\mathsf{RI}}
\newcommand{\LI}{\mathsf{LI}}
\newcommand{\Pass}{\mathsf{P}}
\newcommand{\F}{\mathsf{F}}
\newcommand{\xvdash}{\vdash^{x}}
\newcommand{\yvdash}{\vdash^{y}}

\newcommand{\otd}{\ot^D}
\newcommand{\lollid}{\;\textsuperscript{$D$}\!\!\lolli}

\newcommand{\highlight}[1]{\textcolor{blue}{#1}}

\newcommand{\proofbox}[1]{\begin{tabular}{l} #1 \end{tabular}}

\newcommand{\MILL}{\texttt{MILL}}
\newcommand{\NMILL}{\texttt{NMILL}}
\newcommand{\SkNMILL}{\NMILL\textsuperscript{\textit{s}}}
\newcommand{\FSkMCC}{\mathsf{Free}}

%%\newcommand{\tarmo}[1]{}
%%\newcommand{\niccolo}[1]{}
%%\newcommand{\cheng}[1]{}

\newcommand{\cheng}[1]{{\color{blue}\textbf{Cheng: }#1}}
\newcommand{\niccolo}[1]{{\color{red}\textbf{Niccol{\`o}: }#1}}
\newcommand{\tarmo}[1]{{\color{ForestGreen}\textbf{Tarmo: }#1}}


\title{Proof Theory of Skew Non-Commutative \MILL}
\author{Tarmo Uustalu
\institute{Reykjavik University, Iceland}
\institute{Tallinn University of Technology, Estonia}
\email{tarmo@ru.is}
\and
Niccol{\`o} Veltri \qquad\qquad Cheng-Syuan Wan
\institute{Tallinn University of Technology, Estonia}
\email{\quad niccolo@cs.ioc.ee \quad\qquad cswan@cs.ioc.ee}
}
\def\titlerunning{Proof Theory of Skew Non-Commutative \MILL}
\def\authorrunning{T. Uustalu, N. Veltri \& C.-S. Wan}
\begin{document}
\maketitle
\begin{abstract}
  Monoidal closed categories are standard categorical  models of  \NMILL, non-commutative multiplicative intuitionistic linear logic: the monoidal unit and tensor model the multiplicative unit and conjunction; the internal hom models linear implication. In recent years, the weaker notion of (left) skew monoidal closed category has been proposed by Ross Street, where the three structural laws of left and right unitality and associativity are not required to be invertible, they are merely natural transformations with a specific orientation. A question arises naturally: is it possible to find deductive systems which are naturally modelled by skew monoidal closed categories? We answer positively by introducing a cut-free sequent calculus for a skew version of \NMILL\ that serves this purpose. We study the proof-theoretic semantics of the sequent calculus by identifying a calculus of derivations in normal form, obtained from an adaptation of Andreoli's focusing technique to the skew setting. The resulting focused sequent calculus peculiarly employs a system of tags for keeping track of new formulae appearing in the antecedent and appropriately reducing non-deterministic choices in proof search. Focusing solves the coherence problem for skew monoidal closed categories by exhibiting an effective procedure for deciding equality of canonical maps in all models.

%%   In previous works from Uustalu et al, proof theory of some variants of skew monoidal categories are developed.
%%   We also know that given a skew monoidal category, there is a corresponding skew closed structure on the same category.
%%   It motivates us to develop a proof theory of such skew monoidal closed structures and see its meta properties.
%%
%%   In this paper, a Hilbert-style categorical calculus, a cut-free sequent calculus, and a tagged focused sequent calculus are presented.
%%   We prove the soundness and completeness between categorical calculus and sequent calculus.
%%   Moreover any two equivalent proofs from cut-free sequent calculus are mapped into same derivation in tagged focused calculus.
%%   Therefore we have an effective procedure to determine morphism existence and equivalence in skew monoidal closed categories.
\end{abstract}
\section{Introduction}
It is a well-known fact from the late 80s/early 90s that symmetric monoidal closed categories are standard categorical models of \MILL, multiplicative intuitionistic linear logic, whose logical connectives comprise of multiplicative unit $\I$ and conjunction $\ot$ and linear implication $\lolli$ \cite{mellies:categorical:09}. Probably lesser-known, though a quite straightforward generalization of the previous sentence (which actually predated the inception of linear logic altogether), is the fact that (not necessarily symmetric) monoidal biclosed categories are categorical models of the non-commutative variant of \MILL\ (for which we use the abbreviation \NMILL) \cite{abrusci:noncommutative:1990}, where the structural rule of exchange is absent and there are two ordered implications $\lolli$ and $\illol$ \cite{lambek:deductive:68}. The sequent calculus for \NMILL\ is known as \emph{Lambek calculus}. Lambek refers to the implications $\lolli$ and $\illol$ as residuals, and models of Lambek calculus are therefore also called residual categories. The Lambek calculus is often practically employed in formal investigations of natural languages \cite{lambek:mathematics:58}.
By dropping one of the ordered implications of \NMILL\ one obtains a fragment of the Lambek calculus enjoying categorical semantics in every monoidal closed category.

In recent years, Ross Street introduced the new notion of (left) skew monoidal closed categories \cite{street:skew-closed:2013}. These are a weakening of monoidal closed categories: their structure includes a unit $\I$, a tensor $\ot$, an internal hom $\lolli$ and an adjunction relating the latter two operations, as in usual non-skew monoidal closed categories. The difference lies in the three structural laws of left and right unitality, $\lambda_A : \I \ot A \to A$ and $\rho_A : A \to A \ot \I$, and associativity, $\alpha_{A,B,C} : (A \ot B) \ot C \to A \ot (B \ot C)$, which are usually required to be natural isomorphisms, but in the skew variant are merely natural transformations with the specified orientation. Street originally proposed this weaker notion to reach better understanding of and to fix a famous imbalance, first noticed by Eilenberg and Kelly \cite{eilenberg:closed:1966}, present in the adjunction relating monoidal and closed structures \cite{street:skew-closed:2013,uustalu:eilenberg-kelly:2020}. In the last decade, skew monoidal closed categories, together with their non-closed/non-monoidal variants, have been thoroughly studied, with applications ranging from algebra and homotopy theory to programming language semantics \cite{szlachanyi:skew-monoidal:2012,lack:skew:2012,lack:triangulations:2014,altenkirch:monads:2014,buckley:catalan:2015,bourke:skew:2017,bourke:skew:2018,tomita:realizability:21}.

A question arises naturally: is it possible to characterize skew monoidal closed categories as standard categorical models of a certain logical proof system, e.g. a skew variant of \NMILL?
This paper provides a positive answer to this question. We introduce a cut-free sequent calculus for a skew variant of \NMILL, which we name \SkNMILL. Sequents are peculiarly defined as triples $S \mid \Gamma \vdash A$, where the succedent is a single formula $A$ (as in intuitionistic linear logic), but the antecedent is divided in two parts: an optional formula $S$, called \emph{stoup} \cite{girard:constructive:91}, and an ordered list of formulae $\Gamma$. Inference rules are similar to the ones of \NMILL\ but with specific structural restrictions for accurately capturing the structural laws of skew monoidal closed categories, and nothing more. In particular, and in analogy with \NMILL, the structural rules of contraction, weakening and exchange are all absent. Sets of derivations are quotiented by a congruence relation $\circeq$, carefully crafted to serve as the sequent-calculus counterpart of the equational theory of skew monoidal closed categories. The design of the sequent calculus draws inspiration from, and further advance, the line of work of Uustalu, Veltri and Zeilberger on proof systems for various categories with skew structure: skew semigroup (a.k.a. Tamari order) \cite{zeilberger:semiassociative:19}, skew monoidal (non-closed) \cite{uustalu:sequent:2021,uustalu:proof:nodate} and its symmetric variant \cite{veltri:coherence:2021}, skew prounital (non-monoidal) closed \cite{uustalu:deductive:nodate}.

The metatheory of \SkNMILL\ is developed in two different but related directions:
\begin{enumerate}[($i$)]
  \item We study the categorical semantics of \SkNMILL, by showing that the cut-free sequent calculus admits an interpretation of formulae, derivations and equational theory $\circeq$ in every skew monoidal closed category. Moreover, the sequent calculus is \emph{canonical} among skew monoidal closed categories, in the sense that it gives a particular presentation of the \emph{initial} (also called \emph{term} or \emph{free}) model. This can be made precise by introducing a Hilbert-style calculus which directly represents the initial model and subsequently proving that derivations in the two calculi are in a bijective correspondence.
This shows that the categorical semantics of \SkNMILL\ is sound and
%, most importantly,
complete.
%The latter fact implies that deciding whether a diagram of canonical maps (i.e. structural laws) in an arbitrary skew monoidal category commutes, a problem typically referred to as \emph{coherence} in the categorical literature, can be reduced to checking whether the corresponding derivations in the cut-free sequent calculus are $\circeq$-related.

\item We investigate the proof-theoretic semantics of \SkNMILL, by defining a normalization strategy for sequent calculus derivations wrt.\ the congruence $\circeq$, when the latter is considered as a locally confluent and strongly normalizing reduction relation. The shape of normal forms is made explicit in a new \emph{focused} sequent calculus, whose derivations act as the target of the normalization procedure. The sequent calculus is ``focused'' in the sense of Andreoli \cite{andreoli:logic:1992}, as it implements a sound and complete goal-directed proof search strategy attempting to build a derivation in the (original, unfocused) sequent calculus. The focused system in this paper extends the previously
developed normal forms for skew monoidal categories \cite{uustalu:sequent:2021} and skew prounital closed categories \cite{uustalu:deductive:nodate}. The presence of both positive ($\I$,$\ot$) and negative ($\lolli$) connectives requires some extra care in the implementation of the proof search algorithm, which is reflected in the design of the focused sequent calculus, in particular when aiming at removing all possible non-deterministic choices (wrt.\ the conversion $\circeq$) that can arise during proof search. This is technically realized in the focused sequent calculus by the peculiar employment of a system of \emph{tags} for keeping track of new formulae appearing in the antecedent. The focused sequent calculus can also be seen as a concrete presentation of the initial model for \SkNMILL, and as such can be used for solving the coherence problem in an effective way: deciding commutativity of canonical diagrams in arbitrary skew monoidal categories is equivalent to deciding the \emph{syntactic} equality of the corresponding focused derivations.
\end{enumerate}

%% Srtucture of the paper?
%%
%% Recent discoveries on skew monoidal categories \cite{szlachanyi:skew-monoidal:2012} \cite{lack:skew:2012} \cite{lack:triangulations:2014} (check references in previous papers, at least include papers cited by previous three papers) provide us a good reasons to study their corresponding proof systems.
%% In previous work \cite{uustalu:sequent:2021} \cite{uustalu:deductive:nodate} \cite{uustalu:proof:nodate} \cite{veltri:coherence:2021}, sequent calculus proof system for skew monoidal categories, prounital closed categories, partial normal monoidal categories, and skew symmetric monoidal categories are presented respectively.
%% However, there is still lack of a proof analysis on skew monoidal closed categories.
%% Therefore, in this paper we give sound and complete sequent calculus system with skew monoidal closed categories.
%% Moreover, we use focusing strategy from \cite{andreoli:logic:1992} to solve the coherence problem of skew monoidal closed categories.
%%
%% Interestingly, because of having two connectives in our sequent calculus system, the focusing strategy becomes subtle and involved.
%% It cannot just divide derivations into invertible part and non-invertible part then fix their order.
%% We discovered that it is no harm to arrange invertible rules in a fixed order, but in non-invertible rules, bad thing happens.
%% The naive focused sequent calculus system cannot prove some provable sequents in original sequent calculus.
%% We will see this involved focused sequent calculus system in (?) section.
%%
%% This paper will go through in this order, in section two, we see the Hilbert style calculus of skew monoidal closed categories and its proof equivalences.
%%
%% In third section, a cut-free sequent calculus of skew monoidal closed categories is presented.
%% The key feature is that we have a special formula called stoup at the leftmost position in antecedent of a given sequent.
%% In the same time, for any left rules, it can only be applied to the stoup formula.
%% We will also see preliminarily relationship with Hilbert style calculus.
%%
%% Next section, we will see a focused sequent calculus system and its connection with original sequent calculus system.
%% We will see that all derivations in a same equivalence class under proof conversion relation, they will correspond to a unique derivation in focused system.

The equivalence between sequent calculus derivations, quotiented by the equivalence relation $\circeq$, and focused derivations, that we present in Section \ref{sec:focus}, has been formalized in the Agda proof assistant. The associated code is available at \url{https://github.com/niccoloveltri/code-skewmonclosed}.

\section{A Sequent Calculus for Skew Non-Commutative \MILL}\label{sec2}
In this section we introduce a sequent calculus for a skew variant of non-commutative multiplicative intuitionistic linear logic (\NMILL), that we call \SkNMILL.

Formulae are inductively generated by the grammar $A,B ::= X \ | \ \I \ | \ A \ot B \ | \ A \lolli B$, where $X$ comes from a fixed set $\mathsf{At}$ of atomic formulae, $\I$ is a multiplicative unit, $\ot$ is a multiplicative tensor (or conjunction) and $\lolli$ is a linear implication.

A sequent is a triple of the form $S \mid \Gamma \vdash A$, where the succedent $A$ is a single formula (as in \NMILL) and the antecedent is divided in two parts: an optional formula $S$, called \emph{stoup} \cite{girard:constructive:91}, and an ordered list of formulae $\Gamma$, called \emph{context}. The peculiar design of sequents, involving the presence of the stoup in the antecedent, comes from previous work on deductive systems with skew structure by Uustalu, Veltri and Zeilberger \cite{uustalu:sequent:2021,uustalu:proof:nodate,uustalu:deductive:nodate,veltri:coherence:2021}.
The metavariable $S$ always denotes a stoup, i.e. $S$ can be a single formula or empty, in which case we write $S = -$, and $X,Y,Z$ are always names of atomic formulae.

Derivations of a sequent $S \mid \Gamma \vdash A$ are inductively generated by the following rules:
%\begin{defn}
%  \emph{SkNMILL} is a sequent calculus system whose sequents are in the form of $S \mid \Gamma \vdash A$ coustructed with following rules
\begin{equation}\label{eq:seqcalc}
  \def\arraystretch{2.5}
  \begin{array}{c}
    \infer[\ax]{A \mid \quad \vdash A}{}
    \qquad
    \infer[\pass]{{-} \mid A , \Gamma \vdash C}{A \mid \Gamma \vdash C}
    \qquad
    \infer[\lleft]{A \lolli B \mid \Gamma , \Delta \vdash C}{
      {-} \mid \Gamma \vdash A
      &
      B \mid \Delta \vdash C
    }
    \qquad
    \infer[\lright]{S \mid \Gamma \vdash A \lolli B}{S \mid \Gamma , A \vdash B}
    \\
    \infer[\unitl]{\I \mid \Gamma \vdash C}{{-} \mid \Gamma \vdash C}
    \qquad
    \infer[\tl]{A \ot B \mid \Gamma \vdash C}{A \mid B , \Gamma \vdash C}
    \qquad
    \infer[\unitr]{{-} \mid \quad \vdash \I}{}
    \qquad
    \infer[\tr]{S \mid \Gamma , \Delta \vdash A \ot B}{
      S \mid \Gamma \vdash A
      &
      {-} \mid \Delta \vdash B
    }
  \end{array}
\end{equation}
%\end{defn}


%\niccolo{
%  Explain what the rules do, e.g. when read bottom-up, and what are the differences from the non-skew case
%}

The inference rules in (\ref{eq:seqcalc}) are reminiscent of the ones in the sequent calculus for \NMILL\ \cite{abrusci:noncommutative:1990}, but there are some crucial differences.
\begin{enumerate}
\item The left logical rules $\unitl$, $\tl$ and $\lleft$, read bottom-up, are only allowed to be applied on the formula in the stoup position. In particular, there is no general way to remove a unit $\I$ nor decompose a tensor $A \ot B$ if these formulae are located in the context and not in the stoup (we will see in (\ref{eq:lleft:gen}) that something can actually be done to deal with implications $A \lolli B$ in the context).
\item The right tensor rule $\tr$, read bottom-up, splits the antecedent of the conclusion between the two premises whereby the formula in the stoup, in case such a formula is present, has to be moved to the stoup of the first premise. In particular, the stoup formula of the conclusion cannot be moved to the antecedent of the second premise even if $\Gamma$ is chosen to be empty.
\item The presence of the stoup implies a distinction between antecedents of the form $A \mid \Gamma$ and ${-} \mid \Gamma$. The structural rule $\pass$ (for `passivation'), read bottom-up, allows the moving of the leftmost formula in the context to the stoup position, whenever the stoup is initially empty.
\item The logical connectives of \NMILL\ typically include two ordered implications $\lolli$ and $\illol$, which are two variants of linear implication arising from the removal of the exchange rule from intuitionistic linear logic. In \SkNMILL\ only one of the ordered implications (the left implication $\lolli$) is present. It is currently not clear to us whether the inclusion of the second implication to our logic is a meaningful addition and whether it corresponds to some particular categorical notion.
\end{enumerate}
The restrictions in 1--4 are essential for precisely capturing all the features of skew monoidal closed categories and nothing more, as we discuss in Section \ref{sec:catsem}.
Notice also that, similarly to the case of \NMILL, all structural rules of exchange, contraction, and weakening are absent. We give names to derivations and we write $f : S \mid \Gamma \vdash A$ when $f$ is a particular derivation of the sequent $S \mid \Gamma \vdash A$.

Examples of valid derivations in the sequent calculus, corresponding to structural laws $\lambda$, $\rho$ and $\alpha$ of skew monoidal closed categories (see Definition \ref{def:skewcat}), are given below. %which will help us  understanding the connection with skew monoidal closed categories.
%If we interpret morphism $A \Rightarrow C$ as a sequent $A \mid \quad \vdash C$, then we can see the natural transformations are derivable in this sequent calculus.
%For example, natural transformations $\lambda : \I \ot A \Rightarrow A , \rho : A \Rightarrow A \ot \I$, and $\alpha : (A \ot B) \ot C \Rightarrow A \ot (B \ot C)$ in skew monoidal closed categories are admissible in SkNMILL:
\begin{equation}\label{eq:lra}
  \begin{array}{c@{\;\quad}cc}
  (\lambda) & (\rho) & (\alpha) \\
  \infer[\tl]{\I \ot A \mid \quad \vdash A}{
    \infer[\unitl]{\I \mid A \vdash A}{
      \infer[\pass]{{-} \mid A \vdash A}{
        \infer[\ax]{A \mid \quad \vdash A}{}
      }
    }
  }
  &
  \infer[\tr]{A \mid \quad \vdash A \ot \I}{
    \infer[\ax]{A \mid \quad \vdash A}{}
    &
    \infer[\unitr]{{-} \mid \quad \vdash \I}{}
  }
  &
  \infer[\tl]{(A \ot B) \ot C \mid \quad \vdash A \ot (B \ot C)}{
    \infer[\tl]{A \ot B \mid C \vdash A \ot (B \ot C)}{
      \infer[\tr]{A \mid B , C \vdash A \ot (B \ot C)}{
        \infer[\ax]{A \mid \quad \vdash A}{}
        &
        \infer[\pass]{{-} \mid B , C \vdash B \ot C}{
          \infer[\tr]{B \mid C \vdash B \ot C}{
            \infer[\ax]{B \mid \quad \vdash B}{}
            &
            \infer[\pass]{{-} \mid C \vdash C}{
              \infer[\ax]{C \mid \quad \vdash C}{}
            }
          }
        }
      }
    }
  }
  \end{array}
\end{equation}
Examples of non-derivable sequents include the ``inverses'' of the conclusions in (\ref{eq:lra}), obtained by swapping the stoup formula with the succedent formula.
%Another important thing is that SkNMILL could not prove the inverse of any natural transformations above.
More precisely, the three sequents $X \mid ~ \vdash \I \ot X$, $X \ot \I \mid ~ \vdash X$ and $X \ot (Y \ot Z) \mid ~ \vdash (X \ot Y) \ot Z$ do not have any derivation. All possible attempts of constructing a valid derivation for each of them end in failure.
\begin{displaymath}
  \begin{array}{ccc}
  (\lambda^{-1}) & (\rho^{-1}) & (\alpha^{-1}) \\[6pt]
    \infer[\tr]{X \mid ~\vdash \I \ot X}{
      \deduce[??]{X \mid ~ \vdash \I}{
      }
      &
      \deduce[??]{{-} \mid ~ \vdash X}{
      }
    }
    &
    \infer[\tl]{X \ot \I \mid \quad \vdash X}{
      \deduce{X \mid \I \vdash X}{??}
    }
    &
    \infer[\tl]{X \ot (Y \ot Z) \mid ~\vdash (X \ot Y) \ot Z}{
      \deduce{X \mid Y \ot Z \vdash (X \ot Y) \ot Z}{??}
    } \\
    (\text{$\tr$ sends $X$ to 1st premise}) &
    (\text{$\unitl$ does not act on $\I$ in context}) &
    (\text{$\tl$ does not act on $\ot$ in context})
  \end{array}
\end{displaymath}
% We interpret $\rho^{-1}$ into $A \ot \I \mid \quad \vdash A$, then according to bottom-up proof search strategy, we first apply $\tl$ but we get stuck immediately.
% Therefore, $\rho^{-1}$ is not derivable in our sequent calculus.
% Other cases are similar.
% In categorical semantics section we will see more details about relationship between SkNMILL and free skew monoidal closed categories.
Analogously, the sequents $\I \lolli A \mid ~ \vdash A$ and $(A \ot B) \lolli C \mid ~ \vdash A \lolli (B \lolli C)$ are derivable, while generally their ``inverses'' are not. Also, a derivation of $A \mid ~ \vdash B$ always yields a derivation of $\I \mid ~ \vdash A \lolli B$, but there are $A$, $B$ such that $\I \mid ~ \vdash A \lolli B$ is derivable while  $A \mid ~ \vdash B$ is not (e.g., $A = X$, $B = \I \ot X$).

Sets of derivations are quotiented by a congruence relation $\circeq$, generated by the pairs of derivations in Figure \ref{fig:circeq}. The first three equations are $\eta$-conversions, completely characterizing the $\ax$ rule on non-atomic formulae. The remaining equations are permutative conversions. The congruence $\circeq$ has been carefully chosen to serve as the proof-theoretic counterpart of the equational theory of skew monoidal closed categories, introduced in Definition \ref{def:skewcat}. The subsystem of equations involving only $(\I,\ot)$ originated from \cite{uustalu:sequent:2021}, while the subsystem involving only $\lolli$ comes from \cite{uustalu:deductive:nodate}.
\begin{figure}[t!]\small
\begin{align*}
  \ax_{\I} &\circeq \unitl \text{ } (\unitr)
  \\
  \ax_{A \ot B} &\circeq \tl \text{ } (\tr \text{ } (\ax_{A} , \pass \text{ } \ax_{B}))
  \\
  \ax_{A \lolli B} &\circeq \lright \text{ } (\lleft \text{ } (\pass \text{ } \ax_{A}, \ax_{B} ))
  \\
  \tr \text{ } (\pass \text{ } f, g) &\circeq \pass \text{ } (\tr \text{ } (f, g)) &&f : A' \mid \Gamma \vdash A, g : {-} \mid \Delta \vdash B
  \\
  \tr \text{ } (\unitl \text{ } f, g) &\circeq \unitl \text{ } (\tr \text{ } (f , g)) &&f : {-} \mid \Gamma \vdash A , g : {-} \mid \Delta \vdash B
  \\
  \tr \text{ } (\tl \text{ } f, g) &\circeq \tl \text{ } (\tr \text{ } (f , g)) &&f : A' \mid B' , \Gamma \vdash A , g : {-} \mid \Delta \vdash B
  \\
  \tr \text{ } (\lleft \text{ } (f , g), h) & \circeq \lleft \text{ } (f, \tr \text{ } (g, h)) &&f: {-} \mid \Gamma \vdash A, g : B \mid \Delta \vdash C, h : {-} \mid \Lambda \vdash D
  \\
  \pass \text{ } (\lright \text{ } f) &\circeq \lright \text{ } (\pass \text{ } f) &&f : A' \mid \Gamma , A \vdash B
  \\
  \unitl \text{ } (\lright \text{ } f) &\circeq \lright \text{ } (\unitl \text{ } f) &&f : {-} \mid \Gamma , A \vdash B
  \\
  \tl \text{ } (\lright \text{ } f) &\circeq \lright \text{ } (\tl \text{ } f) &&f : A \mid B , \Gamma , C \vdash D
  \\
  \lleft \text{ } (f, \lright \text{ } g) &\circeq \lright \text{ } (\lleft \text{ } (f, g)) &&f : {-} \mid \Gamma \vdash A', g : B' \mid \Delta , A \vdash B
  \\
\end{align*}
\vspace{-1.5cm}
\caption{Equivalence of sequent calculus derivations}
\label{fig:circeq}
\end{figure}
%\niccolo{
%We should add all equations, not only the ones about the interaction of monoidal and closed structure. Possibly in a Figure since there are plenty of equations.
%}
\begin{theorem}
The sequent calculus enjoys cut admissibility: the following two cut rules are admissible.
  \begin{displaymath}
    \infer[\mathsf{scut}]{S \mid \Gamma , \Delta \vdash C}{
      S \mid \Gamma \vdash A
      &
      A \mid \Delta \vdash C
    }
    \qquad
    \infer[\mathsf{ccut}]{S \mid \Delta_0 , \Gamma , \Delta_1 \vdash C}{
      {-} \mid \Gamma \vdash A
      &
      S \mid \Delta_0 , A , \Delta_1 \vdash C
    }
  \end{displaymath}
\end{theorem}
%\begin{proof}
%  According to previous works \cite{uustalu:sequent:2021} and \cite{uustalu:deductive:nodate} we know two cut rules, $\mathsf{scut}$ and $\mathsf{ccut}$ are admissible in each system separately.
%  As our new sequent calculus system is a union of two previous systems, we can just check the $\ot$ and $\lolli$ interaction cases.
%
%  Dealing with $\mathsf{scut}$ first, same as proof strategy in previous papers, we proof by induction on left premise of $\mathsf{scut}$ rule.
%  \begin{enumerate}[1. ]
%    \item First case is $\mathsf{scut} \text{ } ((\tl \text{ } f), g)$ where $f : A' \mid B' , \Gamma \vdash A, g : A \mid \Delta \vdash C$, then we do subinduction on $g$ to obtain two subcases:
%          \begin{enumerate}[a. ]
%            \item $g = \lright \text{ } g'$, then we let $\mathsf{scut} \text{ } ((\tl \text{ } f), (\lright \text{ } g')) \defeq \lright \text{ } (\mathsf{scut} \text{ } ((\tl \text{ } f), g'))$.
%            \item $g = \lleft \text{ } g'$, then we let $\mathsf{scut} \text{ } ((\tl \text{ } f), (\lright \text{ } g')) \defeq \tl \text{ } (\mathsf{scut} \text{ } (f, (\lright \text{ } g')))$
%          \end{enumerate}
%    \item $\mathsf{scut} \text{ } ((\lleft f \text{ } (f' , f'')), g)$, where $f' : {-} \mid \Gamma' \vdash A'$, $f'' : B' \mid \Gamma'' \vdash A$, and $g : A \mid \Delta \vdash C$.
%    This case is similar as $\mathsf{scut} \text{ } ((\tl \text{ } f), g)$.
%    \item There is no new case for premise is from $\tr$ or $\lright$, because cut formulae are not matched.
%  \end{enumerate}
%  Next we see the cut-freeness of $\mathsf{ccut}$ rule.
%  Similarly, we prove it by induction on the second premise.
%  \begin{enumerate}[1. ]
%    \item $\mathsf{ccut} \text{ } (f , (\lleft \text{ } (g, h)))$ where $f : {-} \mid \Gamma \vdash A$, $g : {-} \mid \Delta_1 \vdash A'$, $h : B' \mid \Delta_2 \vdash C$, then we do subinduciton on $f$:
%    \begin{enumerate}[a. ]
%      \item The only possibility is $A = A' \ot B'$ and $f = \tr (f_1, f_2)$ where $f_1 : {-} \mid \Gamma_1 \vdash A'$, $f_2 : {-} \mid \Gamma_2 \vdash B'$, then depending on $A' \ot B'$ in $\Delta_1$ or $\Delta_2$,
%      we let $\mathsf{ccut} \text{ } (f , (\lleft \text{ } (g, h))) \defeq \lleft \text{ } (\mathsf{ccut} \text{ } (f, g), h)$ or $ \lleft \text{ } (g, (\mathsf{ccut} \text{ } (f, h)))$, respectively.
%    \end{enumerate}
%    \item $\mathsf{ccut} \text{ } (f , (\tr \text{ } (g, h)))$ where $f : {-} \mid \Gamma \vdash A$, $g : S \mid \Delta_1 \vdash A'$, $h : {-} \mid \Delta_2 \vdash B'$ is similar as above.
%    \item $\mathsf{ccut} \text{ } (f, (\tl \text{ } g))$ and
%    $\mathsf{ccut} \text{ } (f, (\lright \text{ } h))$ cases are similar, we permute $\mathsf{ccut}$ up,
%    where $g : A' \mid B' , \Delta_0 , A , \Delta_1 \vdash C$, $h : S \mid \Delta_0 , A , \Delta_1 , A' \vdash B'$.
%  \end{enumerate}
%\end{proof}
The two cut rule satisfy a large number of
$\circeq$-equations, see e.g.~\cite[Figures 5 and 6]{uustalu:sequent:2021} for the
list of such equations not involving $\lolli$.
In particular, the cut rules are well-defined wrt. $\circeq$, in the sense that $\mathsf{scut}(f,g) \circeq \mathsf{scut}(f',g')$ whenever $f \circeq f'$ and $g \circeq g'$, and similarly for $\mathsf{ccut}$.

Here are some other interesting admissible rules.
\begin{itemize}
\item The left rules for $\I$ and $\ot$ are invertible up to $\circeq$, and similarly the right rule for $\lolli$.
%This in particular implies the admissibility of the following rules:
%\begin{displaymath}
%  \infer[\tl^{-1}]{A \mid B, \Gamma \vdash C}{A \ot B \mid \Gamma \vdash C}
%  \qquad
%  \infer[\unitl^{-1}]{{-} \mid \Gamma \vdash C}{\I \mid \Gamma \vdash C}
%  \qquad
%  \infer[\lright^{-1}]{S \mid \Gamma , A \vdash B}{S \mid \Gamma \vdash A \lolli B}
%\end{displaymath}
No other rule is invertible, in particular the
passivation rule $\pass$.

\item
Applications of the invertible left logical rules can be iterated, and similarly for the invertible right $\lright$ rule, resulting in the two admissible rules
\begin{equation}\label{eq:inter:ante}
  \infer[\mathsf{L}^\star]{\ldbc S \mid \Gamma \rdbc_{\ot} \mid \Delta \vdash C}{
    S \mid \Gamma ,\Delta \vdash C
  }
  \qquad
  \infer[\lright^\star]{S \mid \Gamma \vdash \ldbc \Delta \mid C \rdbc_{\lolli}}{
    S \mid \Gamma , \Delta \vdash C
  }
\end{equation}
The interpretation of antecedents $\ldbc S \mid \Gamma \rdbc_{\ot}$ in (\ref{eq:inter:ante}) is the formula obtained by substituting the separator $\mid$ and the commas with tensors: $\ldbc S \mid A_1,\dots,A_n \rdbc_{\ot} = (\dots ((\ldbc S \llangle \ot A_1) \ot A_2) \dots ) \ot A_n$, where $\ldbc {-} \llangle = \I$ and $\ldbc A \llangle = A$.
Dually, the formula $\ldbc \Delta \mid C \rdbc_{\lolli}$ in (\ref{eq:inter:ante}) is obtained by substituting $\mid$ and commas with implications:
$\ldbc A_1,\dots,A_n \mid C \rdbc_{\lolli} = A_1 \lolli (A_2 \lolli (\dots \lolli (A_n \lolli C)))$.

\item
Another left implication rule, acting on a formula $A \lolli B$ in the context, is derivable using cut:
\begin{equation}\label{eq:lleft:gen}
\small
    \!\!\!
  \proofbox{
    \infer[\lleft_{\mathsf{C}}]{S \mid \Delta_0, A \lolli B, \Gamma , \Delta_1 \vdash C}{
      \deduce{{-} \mid \Gamma \vdash A}{f}
      &
      \deduce{S \mid \Delta_0, B , \Delta_1 \vdash C}{g}
    }
  }
  {=}
  \proofbox{
    \infer[\mathsf{ccut}]{S \mid \Delta_0, A \lolli B, \Gamma , \Delta_1 \vdash C}{
      \infer[\pass]{{-} \mid A \lolli B, \Gamma \vdash B}{
        \infer[\lleft]{A \lolli B \mid \Gamma \vdash B}{
          \deduce{{-} \mid \Gamma \vdash A}{f}
          &
          \infer[\ax]{B \mid ~ \vdash B}{}
        }
      }
      &
      \deduce{S \mid \Delta_0, B , \Delta_1 \vdash C}{g}
    }
  }
\end{equation}
\end{itemize}

% There are some useful rules are admissible in SkNMILL.
% \begin{remark}
%   Following rules are admissible in SkNMILL:
%   \begin{displaymath}
%     \infer{\ldbc S \mid \Gamma \rdbc_{\ot} \mid \Delta \vdash C}{
%       S \mid \Gamma ,\Delta \vdash C
%     }
%     \qquad
%     \infer{S \mid \Gamma \vdash \ldbc \Delta \mid C \rdbc_{\lolli}}{
%       S \mid \Gamma , \Delta \vdash C
%     }
%     \qquad
%     \infer{S \mid \Delta_0, A \lolli B, \Gamma , \Delta_1 \vdash C}{
%       {-} \mid \Gamma \vdash A
%       &
%       S \mid \Delta_0, B , \Delta_1 \vdash C
%     }
%   \end{displaymath}
%   Inductive definitions of formulae $\ldbc A \mid \Gamma \rdbc_{\ot}$ (defined as $\ldbc S \mid \Gamma \rdbc_{\ot} = \ldbc S \llangle \text{ } \llangle \Gamma \rdbc_{\ot}$) and $\ldbc \Gamma \mid C \rdbc_{\lolli}$ are originated from \cite{uustalu:sequent:2021} and \cite{uustalu:deductive:nodate} respectively:
%   \begin{align*}
%     \ldbc {-} \llangle = \I \qquad \ldbc A \llangle = A \quad\qquad A \llangle \text{ } \rdbc_{\ot} = A \qquad A \llangle B , \Gamma \rdbc_{\ot} = (A \ot B ) \llangle \text{ } \Gamma \rdbc_{\ot}
%   \end{align*}
%   \begin{displaymath}
%     \ldbc \quad \mid C \rdbc_{\lolli} = C \qquad \ldbc A , \Gamma \mid C \rdbc_{\lolli} = A \lolli \ldbc \Gamma \mid C \rdbc_{\lolli}
%   \end{displaymath}
% \end{remark}

%SkNMILL is a cut-free calculus so we are in a good shape and could discuss more about its correspondence with categorical structures.

%\niccolo{The above proof is interesting, but also quite long. We could move this to the Appendix if we need to make some room in the main text.
%}

%\niccolo{
%  We should mention (in a Proposition?) that some other rules are admissible: inverses of $\unitl$, $\tl$ and $\lright$ (and these are the only invertible ones, in particular $\pass$ is not invertible), and also:
%  \[
%  \infer{\ldbc S \mid \Gamma \rdbc_{\ot} \mid \Delta \vdash C}{
%    S \mid \Gamma ,\Delta \vdash C
%  }
%  \qquad
%  \infer{S \mid \Gamma \vdash \ldbc \Delta \mid C \rdbc_{\lolli}}{
%    S \mid \Gamma , \Delta \vdash C
%  }
%  \qquad
%    {-} \mid \Gamma \vdash A
%    &
%    S \mid \Delta_0, B , \Delta_1 \vdash C
%  }
%  \]
%  The last one using cut. So we could introduce the definitions of $\ldbc S \mid \Gamma \rdbc_{\ot}$ and $\ldbc \Delta \mid C \rdbc_{\lolli}$ at this point.
%  }

%%We have a cut-free proof theory which characterizes skew monoidal closed categories nicely so far.
%%According to Curry-Howard-Lambek correspondence, we can interpret morphisms in skew monoidal closed categories as derivations in the sequent calculus system.
%%This fact allows us to tackle problems in skew monoidal closed categories by methods in proof theory.
%%In particular, we will use Andreoli's focusing technique \cite{andreoli:logic:1992} to analyze and solve coherence problem of skew monoidal closed categories.

\section{Categorical Semantics via Skew Monoidal Closed Categories}
\label{sec:catsem}

%\niccolo{
%I don't think we should give the definition of skew monoidal closed category using all these structural laws and equations, since we know that it can be done with much less (and all this structure takes a lot of room!). I suggest following the definition given in \cite{uustalu:eilenberg-kelly:2020}, using $\lambda$, $\rho$ and $\alpha$ (it is enough to state that there is an adjunction, no need to show $\eta/\epsilon$ nor $p/\mathsf{M}$). Afterwards we can comment on the fact that the definition can equivalently be stated using $i$, $j$ and $L$, and that the adjunction cannot be generally internalized.
%}

%\niccolo{
%I suggest following the discussion in the introduction and proceed as follows:
%\begin{enumerate}
%\item The sequent calculus defines a skew monoidal closed category FSkMCC($\mathsf{At}$) with formulae as objects and set of derivations $A \mid ~ \vdash B$ quotiented by $\circeq$ as homset between objects $A$ and $B$. We already mentioned in the previous section the definitions of $\lambda$, $\rho$ and $\alpha$, I am not sure if that discussion should be moved here.
%\item Given a skew monoidal closed category $\mathbb{C}$, every function $F_{\mathsf{At}} : \mathsf{At} \to \mathbb{C}$, giving an interpretation of atomic formulae as objects of $\mathbb{C}$, extends to a skew monoidal closed functor $F :$ FSkMCC$(\mathsf{At}) \to \mathbb{C}$ (then we should give the definition of skew monoidal closed functor beforehand). This shows that skew monoidal closed categories are categorical models of SkNMILL.
%\item FSkMCC($\mathsf{At}$) is the initial model, a.k.a. the free skew monoidal closed category on $\mathsf{At}$. The proof of this calculus is where we should introduce the Hilbert-style calculus (again with a reduced number of rules/equations). Theorem \ref{thm:wkcomplete} is a consequence of point 1 above, i.e. FSkMCC($\mathsf{At}$) is a skew monoidal closed category. Theorem  \ref{thm:sound} instead follows from point 2.
%\end{enumerate}
%}
\begin{defn}\label{def:skewcat}
A \emph{(left) skew monoidal closed category} $\mathbb{C}$ is a category with a unit object $\I$ and two functors $\ot : \mathbb{C} \times \mathbb{C} \rightarrow \mathbb{C}$ and $\lolli : \mathbb{C}^{\mathsf{op}} \times \mathbb{C} \rightarrow \mathbb{C}$ forming an adjunction ${-} \ot B \dashv B \lolli {-}$ for all $B$,
and three natural transformations $\lambda$, $\rho$, $\alpha$ typed
%\begin{displaymath}
  $\lambda_A : \I \ot A \to A$, $\rho_A : A \to A \ot \I$ and $\alpha_{A,B,C} : (A \ot B) \ot C \to A \ot (B \ot C)$,
%\end{displaymath}
satisfying the following axioms due to Mac Lane \cite{maclane1963natural}:
\begin{center}
  %(m1)
  % https://q.uiver.app/?q=WzAsMyxbMSwwLCJcXEkgXFxvdCBcXEkiXSxbMCwxLCJcXEkiXSxbMiwxLCJcXEkiXSxbMSwwLCJcXHJob197XFxJfSJdLFswLDIsIlxcbGFtYmRhX3tcXEl9Il0sWzEsMiwiIiwyLHsibGV2ZWwiOjIsInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XV0=
\begin{tikzcd}
	& {\I \ot \I} \\[-.2cm]
	\I && \I
	\arrow["{\rho_{\I}}", from=2-1, to=1-2]
	\arrow["{\lambda_{\I}}", from=1-2, to=2-3]
	\arrow[Rightarrow, no head, from=2-1, to=2-3]
\end{tikzcd}
\qquad
%(m2)
% https://q.uiver.app/?q=WzAsNCxbMCwwLCIoQSBcXG90IFxcSSkgXFxvdCBCIl0sWzEsMCwiQSBcXG90IChcXEkgXFxvdCBCKSJdLFsxLDEsIkEgXFxvdCBCIl0sWzAsMSwiQSBcXG90IEIiXSxbMywyLCIiLDAseyJsZXZlbCI6Miwic3R5bGUiOnsiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFszLDAsIlxccmhvX0EgXFxvdCBCIl0sWzEsMiwiQSBcXG90IFxcbGFtYmRhX3tCfSJdLFswLDEsIlxcYWxwaGFfe0EgLCBcXEkgLCBCfSJdXQ==
\begin{tikzcd}
	{(A \ot \I) \ot B} & {A \ot (\I \ot B)} \\[-.3cm]
	{A \ot B} & {A \ot B}
	\arrow[Rightarrow, no head, from=2-1, to=2-2]
	\arrow["{\rho_A \ot B}", from=2-1, to=1-1]
	\arrow["{A \ot \lambda_{B}}", from=1-2, to=2-2]
	\arrow["{\alpha_{A , \I , B}}", from=1-1, to=1-2]
\end{tikzcd}

%(m3)
% https://q.uiver.app/?q=WzAsMyxbMCwwLCIoXFxJIFxcb3QgQSApIFxcb3QgQiJdLFsyLDAsIlxcSSBcXG90IChBIFxcb3QgQikiXSxbMSwxLCJBIFxcb3QgQiJdLFswLDEsIlxcYWxwaGFfe1xcSSAsIEEgLEJ9Il0sWzEsMiwiXFxsYW1iZGFfe0EgXFxvdCBCfSJdLFswLDIsIlxcbGFtYmRhX3tBfSBcXG90IEIiLDJdXQ==
\begin{tikzcd}
	{(\I \ot A ) \ot B} && {\I \ot (A \ot B)} \\[-.3cm]
	& {A \ot B}
	\arrow["{\alpha_{\I , A ,B}}", from=1-1, to=1-3]
	\arrow["{\lambda_{A \ot B}}", from=1-3, to=2-2]
	\arrow["{\lambda_{A} \ot B}"', from=1-1, to=2-2]
\end{tikzcd}
\qquad
%(m4)
% https://q.uiver.app/?q=WzAsMyxbMCwwLCIoQSBcXG90IEIpIFxcb3QgXFxJIl0sWzIsMCwiQSBcXG90IChCIFxcb3QgXFxJKSJdLFsxLDEsIkEgXFxvdCBCIl0sWzAsMSwiXFxhbHBoYV97QSAsIEIsIFxcSX0iXSxbMiwxLCJBIFxcb3QgXFxyaG9fQiIsMl0sWzIsMCwiXFxyaG9fe0EgXFxvdCBCfSJdXQ==
\begin{tikzcd}
	{(A \ot B) \ot \I} && {A \ot (B \ot \I)} \\[-.3cm]
	& {A \ot B}
	\arrow["{\alpha_{A , B, \I}}", from=1-1, to=1-3]
	\arrow["{A \ot \rho_B}"', from=2-2, to=1-3]
	\arrow["{\rho_{A \ot B}}", from=2-2, to=1-1]
\end{tikzcd}

%(m5)
% https://q.uiver.app/?q=WzAsNSxbMCwwLCIoQVxcb3QgKEIgXFxvdCBDKSkgXFxvdCBEIl0sWzIsMCwiQSBcXG90ICgoQiBcXG90IEMpIFxcb3QgRCkiXSxbMiwxLCJBIFxcb3QgKEIgXFxvdCAoQyBcXG90IEQpKSJdLFsxLDEsIihBIFxcb3QgQikgXFxvdCAoQyBcXG90IEQpIl0sWzAsMSwiKChBIFxcb3QgKEJcXG90IEMpIFxcb3QgRCkiXSxbMCwxLCJcXGFscGhhX3tBICwgQlxcb3QgQyAsIER9Il0sWzEsMiwiQSBcXG90IFxcYWxwaGFfe0IgLCBDICxEfSJdLFszLDIsIlxcYWxwaGFfe0EgLEIgLENcXG90IER9IiwyXSxbNCwzLCJcXGFscGhhX3tBIFxcb3QgQiAsIEMgLCBEfSIsMl0sWzQsMCwiXFxhbHBoYV97QSAsIEIgLEN9IFxcb3QgRCJdXQ==
\begin{tikzcd}
	{((A\ot B) \ot C) \ot D} && {A \ot ((B \ot C) \ot D)} \\[-.2cm]
	{(A \ot (B\ot C)) \ot D} & {(A \ot B) \ot (C \ot D)} & {A \ot (B \ot (C \ot D))}
	\arrow["{\alpha_{A , B\ot C , D}}", from=1-1, to=1-3]
	\arrow["{A \ot \alpha_{B , C ,D}}", from=1-3, to=2-3]
	\arrow["{\alpha_{A ,B ,C\ot D}}"', from=2-2, to=2-3]
	\arrow["{\alpha_{A \ot B , C , D}}"', from=2-1, to=2-2]
	\arrow["{\alpha_{A , B ,C} \ot D}", from=2-1, to=1-1]
\end{tikzcd}
\end{center}
\end{defn}
The notion of skew monoidal closed category admits other equivalent characterizations \cite{street:skew-closed:2013,uustalu:eilenberg-kelly:2020}. Tuples of natural transformations $(\lambda , \rho , \alpha)$ are in bijective correspondence with tuples of natural transformations
%\[
($j_A : \I \to A \lolli A$, $i_A : \I \lolli A \to A$, $L_{A,B,C} : B \lolli C \to (A \lolli B) \lolli (A \lolli C)$).
Moreover, $\alpha$ and $L$ are interdefinable with a natural transformation $\mathsf{p}_{A , B , C} : (A \ot B) \lolli C \to A \lolli (B \lolli C)$, representing an internalization of the adjunction between $\ot$ and $\lolli$.
\begin{example}[from \cite{uustalu:eilenberg-kelly:2020}]
This example explains how to turn every categorical model of \MILL\ extended with a $\Box$-like modality of necessity (or something like the exponential modality $!$ of linear logic) into a model of \SkNMILL.
Let $(\mathbb{C},\I,\ot,\lolli)$ be a (possibly symmetric) monoidal closed category and let $(D,\varepsilon, \delta)$ be a comonad on $\mathbb{C}$, where $\varepsilon_A : D\,A \to A$ and $\delta_A : D\,A \to D\,(D\,A)$ are the counit and comultiplication of $D$. Suppose the comonad $D$ to be \emph{lax monoidal}, i.e., coming with a map $\mathsf{e} : \I \to D\,I$ and a natural transformation $\mathsf{m}_{A,B} : D \,A \ot D\,B \to D\,(A \ot B)$ cohering suitably with $\lambda$, $\rho$, $\alpha$, $\varepsilon$ and $\delta$.
Then $\mathbb{C}$ has also a skew monoidal closed structure $(\I, \otd, \lollid)$ given by  $A \otd B = A \ot D\,B$ and $B \lollid C = D\,B \lolli C$. The adjunction ${-} \ot D\,B \dashv D\,B \lolli {-}$ yields an adjunction ${-} \otd B \dashv B \lollid {-}$. The structural laws are
\[
\begin{array}{c}
\lambda^D_A \, = \, \xymatrix@C=3pc{\I \ot D\,A \ar[r]^-{\I \ot \varepsilon_A} & \I \ot A \ar[r]^-{\lambda_A} & A}
\hspace*{1.5cm}
\rho^D_A \, = \, \xymatrix@C=3pc{A \ar[r]^-{\rho_A} & A \ot \I \ar[r]^-{A \ot \mathsf{e}} & A \ot D\,\I}
\\
\begin{array}{rcl}
\alpha^D_{A,B,C} & = & \xymatrix@C=5pc{(A \ot D\,B) \ot D\,C
                   \ar[r]^-{(A \ot D B) \ot \delta_C}
                   & (A \ot D\,B) \ot D\,(D\,C)} \\
& & \hspace*{1.5cm} \xymatrix@C=5pc{\ar[r]^-{\alpha_{A,DB,D(DC)}}
                  & A \ot (D\,B \ot D\,(D\,C)) \ar[r]^-{A \ot \mathsf{m}_{B,DC}}
                  & A \ot D\,(B \ot D\,C)}
\end{array}
\end{array}
\]
$(\mathbb{C},\I,\otd,\lollid)$  is a ``genuine'' skew monoidal closed category, in the sense that $\lambda^D$, $\rho^D$ and $\alpha^D$ are all generally non-invertible.
\end{example}
\begin{defn}
  A \emph{(strict) skew monoidal closed functor} $F : \mathbb{C} \rightarrow \mathbb{D}$ between skew monoidal closed categories $(\mathbb{C} , \I , \ot , \lolli)$ and $(\mathbb{D} , \I' , \ot' , \lolli')$ is a functor from $\mathbb{C}$ to $\mathbb{D}$ satisfying
%   \begin{align*}
%     F \I \cong \I' \qquad F (C_{1} \ot C_{2}) \cong F C_{1} \ot' F C_{2} \qquad
%     F(C_{1} \lolli C_{2}) \cong F C_{1} \lolli' F C_{2}
%   \end{align*}
%   and preserving strutural laws $\lambda$, $\rho$, and $\alpha$ and .
%   \\
%   A skew monoidal closed functor is strict if
%  \begin{align*}
    $F \I = \I'$, $F (A \ot B) = F A \ot' F B$ and
    $F(A \lolli B) = F A \lolli' F B$, also preserving  structural laws $\lambda$, $\rho$, and $\alpha$ on the nose.
%  \end{align*}
\end{defn}
%Next we show that given any skew monoidal closed category $\mathbb{C}$ and a function $F_{\mathsf{At}} : \mathsf{At} \rightarrow \mathbb{C}$ providing interpretation of atomic formulae as objects of $\mathbb{C}$, we can extend function $F_{\mathsf{At}}$ to a skew monoidal closed functor $F : \text{FSkMCC} \rightarrow \mathbb{C}$.
%From now on we drop the attribute ``strict''.

The formulae, derivations and the equivalence relation $\circeq$ of the sequent calculus for \SkNMILL\ determine a skew monoidal closed category $\FSkMCC(\mathsf{At}$).
\begin{defn}\label{def:fskmcc}
  The skew monoidal closed category $\FSkMCC(\mathsf{At})$ has
  as objects formulae, in particular the operations $\I$, $\ot$ and $\lolli$ are the logical connectives. The set of maps between formulae $A$ and $B$ is the set of derivations $A \mid ~ \vdash B$ quotiented by the equivalence relation $\circeq$. The identity map is the equivalence class of $\ax$, while composition is given by $\mathsf{scut}$. Derivations for the structural laws $\lambda$, $\rho$,$\alpha$ are given in (\ref{eq:lra}). All the equations of skew monoidal closed categories hold up to $\circeq$.
\end{defn}

Skew monoidal closed categories correspond precisely to categorical models of \SkNMILL, in the sense specified by the following theorem.
\begin{theorem}\label{thm:models}
  Let $\mathbb{C}$ be a skew monoidal closed category. Given $F_{\mathsf{At}} : \mathsf{At} \rightarrow |\mathbb{C}|$ providing the interpretation of atomic formulae as objects of $\mathbb{C}$, there exists a skew monoidal closed functor $F : \FSkMCC(\mathsf{At}) \rightarrow \mathbb{C}$.
\end{theorem}
\begin{proof}
  Let $(\mathbb{C} , \I' , \ot' , \lolli')$ be a skew monoidal closed category.
  The action on object $F_0$ of the functor $F$ is defined by induction on the input formula:
%  Let $\mathsf{Fma}$ denote the collection of \FSkMCC($\mathsf{At}$) and $\mathbb{C}_{0}$ denote the collection of $\mathbb{C}$, then we can define a mapping $F_{0} : \mathsf{Fma} \rightarrow \mathbb{C}_{0}$
  \begin{equation*}
    F_0X = F_{\mathsf{At}}X
    \qquad
    F_0\I = \I'
    \qquad
    F_0(A \ot B) = F_0A \ot' F_0B
    \qquad
    F_0(A \lolli B) = F_0A \lolli' F_0B
%    F (A)=
%    \begin{cases}
%      F_{\mathsf{At}} (A) &\text{if } A \text{ is atomic}
%      \\
%      \I' &\text{if } A = \I
%      \\
%      F_{\mathsf{At}} (B) \ot' F_{\mathsf{At}} (C) &\text{if } A = B \ot C
%      \\
%      F_{\mathsf{At}} (B) \lolli' F_{\mathsf{At}} (C) &\text{if } A = B \lolli C
%    \end{cases}
  \end{equation*}
  The encoding of antecedents as formulae $\ldbc S \mid \Gamma \rdbc_{\ot}$, introduced immediately after (\ref{eq:inter:ante}), can be replicated also in $\mathbb{C}$ by simply replacing $\ot$ with $\ot'$ in the definition, where now $S$ is an optional object and $\Gamma$ is a list of objects of $\mathbb{C}$. Using this encoding, it is possible to show that each rule in (\ref{eq:seqcalc}) is derivable in $\mathbb{C}$. As an illustrative case, consider the rule $\pass$. Assume given a map $f : \ldbc A \mid \Gamma \rdbc_{\ot'} \to C$ in $\mathbb{C}$. Then, assuming $\Gamma = A_1,\dots,A_n$, we can define the passivation of $f$ typed $\ldbc {-} \mid A, \Gamma \rdbc_{\ot'} \to C$ as
\[\xymatrixcolsep{7pc}
\xymatrix{
  (\dots ((\I \ot' A_1) \ot' A_2) \dots ) \ot' A_n
  \ar[r]^-{(\dots (\lambda_{A_1} \ot' A_2) \dots ) \ot' A_n} &
  (\dots (A_1 \ot' A_2) \dots ) \ot' A_n
  \ar[r]^-{f} &
  C
}
\]
This implies the existence of a function $F_1$, sending each derivation $f : S \mid \Gamma \vdash A$ to a map $F_1f : F_0(\ldbc S \mid \Gamma \rdbc_{\ot}) \to FA$ in $\mathbb{C}$, defined by induction on the derivation $f$. When restricted to sequents of the form $A \mid ~ \vdash B$, the function $F_1$ provides the action on maps of $F$.
It is possible to show that $F$ preserves the skew monoidal closed structure, so it is a skew monoidal closed functor.
%$\mathbb{C}$.
%A \mid \quad \vdash B \to \mathbb{C} (F_{0} (A), F_{0} (B))$
%inductively.  Integrating mapping $F_{0}$ and $F_{1}$, we have a skew
%monoidal closed functor from \FSkMCC($\mathsf{At}$) to $\mathbb{C}$.
%This fact tells us that any skew monoidal closed category is also a
%categorical model of SkMNILL.
\end{proof}
\begin{theorem}\label{thm:unique}
  The skew monoidal closed functor $F$ constructed in Theorem \ref{thm:models}, providing the evaluation of all the syntactic constructs in any model $\mathbb{C}$, is the unique one for which $F_0 X = F_{\mathsf{At}} X$, for any atom $X$.
\end{theorem}
In other words, the
sequent calculus of Section \ref{sec2} is the \emph{initial} model of \SkNMILL, or, equivalently, $\FSkMCC(\mathsf{At})$ is the \emph{free} skew
monoidal closed category on the set $\mathsf{At}$. The uniqueness of $F$ can be proved directly.  Alternatively, following the strategy of our previous papers \cite{uustalu:sequent:2021,uustalu:proof:nodate,uustalu:deductive:nodate,veltri:coherence:2021}, this can be shown by introducing a Hilbert-style deductive system corresponding to a direct implementation of the free skew monoidal closed category on $\mathsf{At}$. Its formulae are the same of the sequent calculus, its sequents are pairs $A \Rightarrow B$, with $A$ and $B$ single formulae. Derivations are generated by the following rules, in which it is possible to  recognize all the structure of Definition \ref{def:skewcat} (in particular $\pi$ and $\pi^{-1}$ are the adjunction data).
%  Next we
%consider the free construction of skew monoidal closed category over a
%set $\mathsf{At}$ with Hilbert-style presentation.
%  \begin{defn}
%    A free skew monoidal closed category \FSkMCC($\mathsf{At}$)$_{H}$ whose objects is $\mathsf{Fma}$ and derivations are sequents $A \Rightarrow C$ is a Hilbert-style sequent calculus system (categorical calculus) constructed from following inference rules
\begin{displaymath}
  \def\arraystretch{1.5}
  \begin{array}{c}
        \infer[\id]{A \Rightarrow A}{}
        \qquad
        \infer[\mathsf{comp}]{A \Rightarrow C}{
          A \Rightarrow B
          &
          B \Rightarrow C
        }
%    \end{displaymath}
        %    \begin{displaymath}
        \qquad
      \infer[\otimes]{A \ot B \Rightarrow C \ot D}{
        A \Rightarrow C
        &
        B \Rightarrow D
      }
      \qquad
      \infer[\lolli]{A \lolli B \Rightarrow C \lolli D}{
        C \Rightarrow A
        &
        B \Rightarrow D
      }
%    \end{displaymath}
      %    \begin{displaymath}
      \\
      \infer[\lambda]{\I \ot A \Rightarrow A}{}
      \quad
      \infer[\rho]{A \Rightarrow A \ot \I}{}
      \quad
      \infer[\alpha]{(A \ot B) \ot C \Rightarrow A \ot (B \ot C)}{}
%    \end{displaymath}
      %    \begin{displaymath}
      \quad
      \infer[\pi]{A \Rightarrow B \lolli C}{A \ot B \Rightarrow C}
      \quad
      \infer[\pi^{-1}]{A \ot B \Rightarrow C}{A \Rightarrow B \lolli C}
  \end{array}
\end{displaymath}
%    satisfying following equations
%    \begin{align*}
%      \id \circ f \doteq f \qquad f \doteq f \circ \id \qquad (f \circ g) \circ h \doteq f \circ (g \circ h) &&\text{(category laws)}
%      \\
%      \id \ot \id \doteq \id \qquad (h \circ f) \ot (k \circ g) \doteq h \ot k \circ f \ot g &&(\ot \text{ functorial})
%      \\
%      \id \lolli \id \doteq \id \qquad (h \circ f) \ot (k \circ g) \doteq f \lolli k \circ h \lolli g &&(\lolli \text{ functorial})
%    \end{align*}
%    \begin{align*}
%        \lambda \circ \id \ot f \doteq f \circ \lambda
%        \\
%        \rho \circ f \doteq f \ot \id \circ \rho &&\lambda , \rho , \alpha \text{ are natural transformations}
%        \\
%        \alpha \circ (f \ot g) \ot h \doteq f \ot (g \ot h) \circ \alpha
%        %%%%Extra natural version?
%        %f \lolli (g \lolli h) \circ p \doteq p \circ (f \ot g) \lolli h
%        %\\
%        %f \lolli h \circ \mathsf{M} \doteq \mathsf{M} \circ (g \lolli h) \ot (f \lolli g)
%        %%%%Extra natural version?
%    \end{align*}
%    \begin{align*}
%        \lambda \circ \rho \doteq \id \qquad \id \doteq \id \ot \lambda \circ \alpha \circ \rho \ot \id
%        \\
%        \lambda \circ \alpha \doteq \lambda \ot \id \qquad \alpha \circ \rho \doteq \id \ot \rho
%        &&\text{(m1)-(m5)}
%        \\
%        \alpha \circ \alpha \doteq
%        \id \ot \alpha \circ \alpha \circ \alpha \ot \id
%    \end{align*}
%  \end{defn}
%\begin{fact}
%  Natural transformations $i$, $j$, $\msfL$, $\mathsf{p}$, and $\eta : A \Rightarrow B \lolli (A \ot B)$ and inference rule
%  \begin{displaymath}
%    \infer[\mathsf{adj}_{2}]{A \ot B \Rightarrow C}{A \Rightarrow B \lolli C}
%  \end{displaymath}
%   are interdefinable with $\lambda$, $\rho$, $\alpha$, $\epsilon$, and $\mathsf{adj}_{1}$.
%  \begin{align*}
%    i &\defeq \mathsf{comp} \text{ } (\rho ,  (\mathsf{adj_2} \text{ } \id))
%    \\
%    j &\defeq \mathsf{adj_1} \text{ } \lambda
%    \\
%    \msfL &\defeq \mathsf{adj_1} \text{ } (\mathsf{adj_1} \text{ } (\mathsf{comp} \text{ } (\alpha , (\mathsf{comp} \text{ } (\id \ot \epsilon) , \epsilon))))
%    \\
%    \eta &\defeq \mathsf{adj_1} \text{ } \id
%    \\
%    \mathsf{adj_2} &\defeq \comp \text{ } ((f \ot \id), \epsilon) && f : A \Rightarrow B \lolli C
%    \\
%    \mathsf{p} &\defeq \comp \text{ } (\msfL , (\eta \lolli \id))
%    %\\
%    %\mathsf{M} &\defeq \comp \text{ } ((\msfL \ot \id) , \epsilon)
%  \end{align*}
%\end{fact}
There exists a congruence relation $\doteq$ on each set of derivations $A \Rightarrow B$ with generators directly encoding the equations of the theory of skew monoidal closed categories. With the Hilbert-style calculus in place, one can show that there is a bijection between the set of derivations of the sequent $A \mid ~ \vdash B$ modulo $\circeq$ and the set of derivations of the sequent $A \Rightarrow B$ modulo $\doteq$.
%The left-to-right function underlying these equivalence is constructible following the receipe specified in Theorem \ref{thm:models}, while the right-to-left function follows from the fact that the Hilbert-style c\FSkMCC($\mathsf{At}$) is a skew monoidal closed category (Definition \ref{def:fskmcc})

%Soundness and completeness among \FSkMCC($\mathsf{At}$)$_{H}$ and \FSkMCC($\mathsf{At}$) is justified because we can prove bijection of derivations (quotiented by $\doteq$ and $\circeq$ respectively) between these two deductive systems by induction on derivations.

\section{Proof-Theoretic Semantics via Focusing}
\label{sec:focus}
The equivalence relation $\circeq$ of Figure \ref{fig:circeq} can also be viewed as an abstract rewrite system, by orienting every equation from left to right. The resulting rewrite system is locally confluent and strongly normalizing, thus confluent with unique normal forms. Derivations in normal form thus correspond to canonical representatives of $\circeq$-equivalence classes.
These representatives can be organized in a \emph{focused sequent calculus} \cite{andreoli:logic:1992}, which implements a goal-directed proof search strategy attempting to build a derivation in the (original, unfocused) sequent calculus.

\subsection{A First (Na{\"i}ve) Focused Sequent Calculus}
As a first attempt to focusing, we na{\"i}vely merge together the rules of the focused sequent calculi of skew monoidal categories \cite{uustalu:sequent:2021} and skew prounital closed categories \cite{uustalu:deductive:nodate}. In the resulting calculus, sequents have one of 4 possible subscript annotations, corresponding to 4 different phases of proof search: $\RI$ for `right invertible', $\LI$ for `left invertible`, $\Pass$ for `passivation` and $\F$ for `focusing`. We will see soon that this focused sequent calculus is too permissive, in the sense that two syntactically distinct derivations in the focused system can correspond to $\circeq$-related sequent calculus derivations.
%We develop a naive focused calculus according to the framework above and immediately bump into a problem that the naive systme contains too much non-determinacy.
%We will show the naive focused sequent calculus and why too much non-determinacy arises, then fix the problem.
%Derivations in the are generated by the rules
\begin{equation}\label{eq:naive}
%  \def\arraystretch{2.5}
  \begin{array}{lc}
    \text{(right invertible)} & %\\ &
    \proofbox{
    \infer[\lright]{S \mid \Gamma \vdash_{\RI} A \lolli B}{S \mid \Gamma , A \vdash_{\RI} B}
    \qquad
    \infer[\LI 2 \RI]{S \mid \Gamma \vdash_{\RI} P}{S \mid \Gamma \vdash_{\LI} P}
    }
%  \end{displaymath}
    %  \begin{displaymath}
    \\[6pt]
    \text{(left invertible)} & %\\ &
    \proofbox{
    \infer[\unitl]{\I \mid \Gamma \vdash_{\LI} P}{{-} \mid \Gamma \vdash_{\LI} P}
    \qquad
    \infer[\tl]{A \ot B \mid \Gamma \vdash_{\LI} P}{A \mid B , \Gamma \vdash_{\LI} P}
    \qquad
    \infer[\Pass 2 \LI]{T \mid \Gamma \vdash_{\LI} P}{T \mid \Gamma \vdash_{\Pass} P}
    }
%  \end{displaymath}
    %  \begin{displaymath}
    \\[6pt]
    \text{(passivation)} & %\\ &
%    \hspace{-1.7cm}
    \proofbox{
      \infer[\pass]{{-} \mid A , \Gamma \vdash_{\Pass} P }{
      A\mid \Gamma \vdash_{\LI} P
    }
    \qquad
%    \\[6pt]
%    \multicolumn{2}{c}{
    \infer[\F 2 \Pass]{T \mid \Gamma \vdash_{\Pass} P}{
      T \mid \Gamma \vdash_{\F} P
    }
    }
%    }
%  \end{displaymath}
    %  \begin{displaymath}
    \\
    \text{(focusing)} &    \\ %&
    %\hspace{-2.4cm}
    \multicolumn{2}{c}{
    \infer[\ax]{X \mid \quad \vdash_{\F} X}{}
    \quad
    \infer[\unitr]{{-} \mid \quad \vdash_{\F} \I}{}
    \quad
    \infer[\tr]{T \mid \Gamma , \Delta \vdash_{\F} A \ot B}{
      T \mid \Gamma \vdash_{\RI} A
      &
      {-} \mid \Delta \vdash_{\RI} B
    }
    \quad
    \infer[\lleft]{A \lolli B \mid \Gamma , \Delta \vdash_{\F} P}{
      {-} \mid \Gamma \vdash_{\RI} A
      &
      B \mid \Delta \vdash_{\LI} P
    }
    }
%  \end{displaymath}
%  \begin{displaymath}
  \end{array}
\end{equation}
In the rules above and the rest of the paper, the metavariable $P$ denotes a \emph{positive} formula, i.e. $P \not= A \lolli B$, while metavariable $T$ indicates a \emph{negative} stoup, i.e. $T \not= \I$ and $T\not= A \ot B$ ($T$ can also be empty).

We explain the rules of the focused sequent calculus from the perspective of bottom-up proof search. The starting phase is `right invertible` $\RI$. %We start by analyizing the proof search of a sequent $S \mid \Gamma \vdash_{\RI} C$.
\begin{itemize}
\item[($\vdash_\RI$)] We repeatedly apply the right invertible rule $\lright$ with the goal of reducing the succedent to a positive formula $P$.
  %In phase $\bullet$, we keep track of all the formulae moved to the right end of the context by marking them with a black tag $\bullet$.
  When the succedent formula becomes positive, we move to phase $\LI$ via $\LI2\RI$.
  %keeping the same tag $x$.
\item[($\vdash_\LI$)] We repeatedly destruct the stoup formula via application of left invertible rules $\tl$ and $\unitl$ with the goal of making it negative. When this happens, we move to phase $\Pass$ via $\Pass2\LI$.
  %keeping the same tag $x$. Notice that  the formula $B$ in the premise of rule $\tl$ does not get marked with a tag.
  %In this phase we do not need to enforce the order between $\unitl$ and $\tl$ applicaitons because they are not exchangeable.
\item[($\vdash_\Pass$)] We have the possibility of applying the passivation rule and move the leftmost formula $A$ in the context to the stoup, when the latter is empty. This allows us to start decomposing $A$ using left invertible rules in phase $\LI$. Otherwise we move to phase $\F$ via $\F2\Pass$.
%  where only $\pass$ can be applied to sequents.
%  Notice that for the active formula in each application of $\pass$, we remove its tag and the sequent goes back to phase $\LI$ to decompose stoup formula again because the passviated formula $A$ could be reducible.
\item[($\vdash_\F$)] We apply one of the four remaining rules $\ax$, $\unitr$, $\tr$ or $\lleft$. The premises of $\tr$ are both in phase $\RI$ since $A$ and $B$ are generic formulae, in particular they could be implications. The first premise of $\lleft$ is in phase $\RI$ for the same reason, while the second premise is in $\LI$ because the succedent formula $P$ is positive.
\end{itemize}

The focused sequent calculus in (\ref{eq:naive}) is sound and complete wrt. the sequent calculus in (\ref{eq:seqcalc}), but not \emph{equationally complete}, i.e., there exist $\circeq$-related sequent calculus derivations which have multiple distinct derivations using the rules in (\ref{eq:naive}). In other words, the rules in (\ref{eq:naive}) are too permissive. There are in fact two forms on non-determinism that can arise:
\begin{enumerate}
\item The first premise of the $\tr$ rule is in phase $\RI$, since $A$ is potentially an implication which the invertible right rule $\lright$ could act upon. Proof search for the first premise eventually hits phase $\Pass$, when we have the possibility of applying the $\pass$ rule if the stoup is empty. This implies the existence of situations where either of the rules $\tr$ and $\pass$ can be applied first, in both cases resulting in valid focused derivations.
%  The other occurs when we decompose $\ot$ in succedent, left premise goes back to phase $\RI$, so if the left premise of $\tr$ application is empty, then $\pass$ could be applied in phase $\Pass$.
  As an example, consider the two distinct derivations of ${-} \mid X , \Gamma , \Delta \vdash_{\Pass} P \ot C$ under assumptions $f : X \mid \Gamma \vdash_{\LI} P$ and $g : {-} \mid \Delta \vdash_{\RI} C$.
  \begin{equation}\label{eq:passtr}
%  \vcenter{
%  \text{(1)}
    %  \quad
    \proofbox{
%    \infer[\mathsf{sw}]{{-} \mid X , \Gamma , \Delta \vdash_{\RI} P \ot C}{
      \infer[\pass]{{-} \mid X , \Gamma , \Delta \vdash_{\Pass} P \ot C}{
        \infer[\mathsf{sw}]{X \mid \Gamma , \Delta \vdash_{\LI} P \ot C}{
          \infer[\tr]{X \mid \Gamma , \Delta \vdash_{\F} P \ot C}{
            \infer[\mathsf{sw}]{X \mid \Gamma \vdash_{\RI} P}{
              \deduce{X \mid \Gamma \vdash_{\LI} P}{f}
            }
            &
            \deduce{{-} \mid \Delta \vdash_{\RI} C}{g}
          }
        }
      }
%    }
%    }
    \qquad
%    \proofbox{
    \infer[\mathsf{sw}]{{-} \mid X , \Gamma , \Delta \vdash_{\Pass} P \ot C}{
      \infer[\tr]{{-} \mid X , \Gamma , \Delta \vdash_{\F} P \ot C}{
        \infer[\mathsf{sw}]{{-} \mid X , \Gamma \vdash_{\RI} P}{
          \infer[\pass]{{-} \mid X , \Gamma \vdash_{\Pass} P}{
            \deduce{X \mid \Gamma \vdash_{\LI} P}{f}
          }
        }
        &
        \deduce{{-} \mid \Delta \vdash_{\RI} C}{g}
      }
    }
    }
%    \text{(2)}
%    \quad
%  }
  \end{equation}
  The rule $\mathsf{sw}$ above stands for a sequence of (appropriately typed) phase
  switching inferences by $\LI2\RI$, $\Pass2\LI$ and $\F2\Pass$.
  The congruence relation $\circeq$ eliminates this form of non-determinism through the 4th equation in Figure \ref{fig:circeq}, i.e. the permutative conversion involving $\tr$ and $\pass$.
  \item Rules $\tr$ and $\lleft$ appear in the same phase $\F$, though there are situations where both rules can be applied first, which can lead to two valid but distinct focused derivations. More precisely, there are cases when $\tr$ and $\lleft$ can be interchangeably applied. As an example, consider the following two valid derivations of $A \lolli X \mid \Gamma , \Delta , \Lambda \vdash_{\F} P \ot D$ under the assumption of $f : {-} \mid \Gamma \vdash_{\RI} A$, $g : X \mid \Delta \vdash_{\LI} P$ and $h : {-} \mid \Lambda \vdash_{\RI} D$.
%  In this case $\tr$ and $\lleft$ rule applications are interchangeable.
%  For convenience, we define an abbreviation of consecutive phase switching rule applications under suitable condition
%  \begin{displaymath}
%    \infer[\mathsf{sw}]{S \mid \Gamma \vdash_{ph} C}{S \mid \Gamma \vdash_{ph} C}
%  \end{displaymath}
%  then we can see how the non-determinacy arises.
  %Without loose of generality, we assume $\Gamma, \Delta$, and $\Lambda$ are sufficient and necessary in proving each sequent respectively.
  %In tagged focused calculus, such exchangeable situation would not happen.
%  Given a sequent $A \lolli B \mid \Gamma , \Delta , \Lambda \vdash_{\RI} C \ot D$ and supposed that $B$ is negative and $C$ is positive, then
%  we can do a bottom-up proof search according to our naive focused sequent calculus:
    \begin{equation}\label{eq:llefttr}
      \hspace{-.5cm}
      \proofbox{
%    \infer[\mathsf{sw}]{A \lolli X \mid \Gamma , \Delta , \Lambda \vdash_{\RI} P \ot D}{
      \infer[\lleft]{A \lolli X \mid \Gamma , \Delta , \Lambda \vdash_{\F} P \ot D}{
        \deduce{{-} \mid \Gamma \vdash_{\RI} A}{f}
        &\hspace{-.6cm}
        \infer[\mathsf{sw}]{X \mid \Delta , \Lambda \vdash_{\LI} P \ot D}{
          \infer[\tr]{X \mid \Delta , \Lambda \vdash_{\F} P\ot D}{
            \infer[\mathsf{sw}]{X \mid \Delta \vdash_{\RI} P}{
              \deduce{X \mid \Delta \vdash_{\LI} P}{g}
            }
            &
            \deduce{{-} \mid \Lambda \vdash_{\RI} D}{h}
          }
        }
      }
%    }
%    }
      \hspace{.2cm}
%    \quad
%  \end{displaymath}
%  However, there is another proof of for $A \lolli B \mid \Gamma , \Delta , \Lambda \vdash_{\RI} C \ot D$
    %  \begin{displaymath}
%    \proofbox{
%    \infer[\mathsf{sw}]{A \lolli X \mid \Gamma , \Delta , \Lambda \vdash_{\RI} P\ot D}{
      \infer[\tr]{A \lolli X \mid \Gamma , \Delta , \Lambda \vdash_{\F} P \ot D}{
        \infer[\mathsf{sw}]{A \lolli X \mid \Gamma , \Delta \vdash_{\RI} P}{
          \infer[\lleft]{A \lolli X \mid \Gamma , \Delta \vdash_{\F} P}{
            \deduce{{-} \mid \Gamma \vdash_{\RI} A}{f}
            &
            \deduce{X \mid \Delta \vdash_{\LI} P}{g}
          }
        }
        &\hspace{-.6cm}
        \deduce{{-} \mid \Lambda \vdash_{\RI} D}{h}
      }
    }
%    }
    \end{equation}
    This form of non-determinism is tamed in the congruence relation $\circeq$ by the last permutative conversion in Figure \ref{fig:circeq}, involving $\tr$ and $\lleft$.
\end{enumerate}

%In summary, two counter-example above show that our naive focused sequent calculus contains too much non-determinacy.
One might try a similar idea in the skew monoidal \emph{non-closed} case \cite{uustalu:sequent:2021} to solve the type 1 non-determinism, i.e., to prioritize $\pass$ over $\tr$ by requiring the first premise of the latter to be a sequent in phase $\F$.
However, this does not work in the skew monoidal closed case, e.g., the sequent ${-} \mid Y \vdash_{\F} (X \lolli X) \ot Y$ would not be derivable, but its counterpart is derivable in (\ref{eq:seqcalc}).
\begin{equation*}\label{eq:counterexample0}
  \infer[\tr]{{-} \mid Y \vdash_{\F} (X \lolli X) \ot Y}{
    \deduce{{-} \mid \quad \vdash_{\F} X \lolli X}{??}
    &
    \infer[\mathsf{sw}]{{-} \mid Y \vdash_{\RI} Y}{
      \infer[\pass]{{-} \mid Y \vdash_{\Pass} Y}{
        \infer[\mathsf{sw}]{Y \mid \quad \vdash_{\LI} Y}{
          \infer[\ax]{Y \mid \quad \vdash_{\F} Y}{}
        }
      }
    }
  }
\end{equation*}

An impulsive idea for solving the non-determinism of type 2 is to prioritize the application of $\lleft$ over $\tr$, e.g., by forcing the application of $\lleft$ in phase $\F$ whenever the stoup formula is an implication and restricting the application of $\tr$ to sequents where the stoup formula is atomic. This idea would lead to an unsound calculus, since the sequent $X \lolli Y \mid Z \vdash_{\F} (X \lolli Y) \ot Z$, which has a derivable correspondent in (\ref{eq:seqcalc}), would not be provable by first applying the $\lleft$ rule.
\begin{equation*}\label{eq:counterexample1}
   \infer[\lleft]{X \lolli Y \mid Z \vdash_{\F} (X \lolli Y) \ot Z}{
     \deduce{{-} \mid \quad \vdash_{\RI} X}{??}
     &
     \infer[\mathsf{sw}]{Y \mid Z \vdash_{\LI} (X \lolli Y) \ot Z}{
       \infer[\tr]{Y \mid Z \vdash_{\F} (X \lolli Y) \ot Z}{
         \infer[\lright]{Y \mid \quad \vdash_{\RI} X \lolli Y}{
           \deduce{Y \mid X \vdash_{\RI} Y}{??}
         }
         &
         \infer[\mathsf{sw}]{{-} \mid Z \vdash_{\RI} Z}{
           \infer[\pass]{{-} \mid Z \vdash_{\Pass} Z}{
             \infer[\mathsf{sw}]{Z \mid \quad \vdash_{\LI} Z}{
               \infer[\ax]{Z \mid \quad \vdash_{\F} Z}{}
             }
           }
         }
       }
     }
   }
\end{equation*}
Dually, prioritizing the application of $\tr$ over $\lleft$ leads to similar issues, e.g., the sequent $X \lolli (Y \ot Z) \mid X \vdash_\F Y \ot Z$ would not be derivable by first applying the $\tr$ rule, although its counterpart is derivable in  (\ref{eq:seqcalc}).
\begin{equation*}\label{eq:counterexample2}
\infer[\tr]{X \lolli (Y \ot Z) \mid X \vdash_{\F} Y \ot Z}{
  \infer[\mathsf{sw}]{X \lolli (Y \ot Z) \mid X \vdash_{\RI} Y}{
    \infer[\lleft]{X \lolli (Y \ot Z) \mid X \vdash_{\F} Y}{
      \infer[\mathsf{sw}]{{-}  \mid X \vdash_{\RI} X}{
        \infer[\pass]{{-}  \mid X \vdash_{\Pass} X}{
          \infer[\mathsf{sw}]{X \mid \quad \vdash_{\LI} X}{
            \infer[\ax]{X \mid \quad \vdash_{\F} X}{}
          }
        }
      }
      &
      \infer[\tl]{Y \ot Z \mid \quad \vdash_{\LI} Y}{
        \deduce{Y \mid Z \vdash_{\LI} Y}{??}
      }
    }
  }
  &
  \deduce{{-}  \mid \quad \vdash_{\RI} Z}{??}
}
\end{equation*}
%It seems can eliminate non-determinacy but a new problem occurs.
%Some provable sequents in \SkNMILL \text{ } become non-provable in focused system.
%
%For example, consider sequent $X \lolli Y \mid Z \vdash_{\RI} (X \lolli Y) \ot Z$ when we favor $\lleft$ than $\tr$.
%\begin{displaymath}
%  \infer[\mathsf{sw}]{X \lolli Y \mid Z \vdash_{\RI} (X \lolli Y) \ot Z}{
%    \infer[\lleft]{X \lolli Y \mid Z \vdash_{\F} (X \lolli Y) \ot Z}{
%      \deduce{- \mid \quad \vdash_{\RI} X}{??}
%      &
%      \infer[\mathsf{sw}]{Y \mid Z \vdash_{\LI} (X \lolli Y) \ot Z}{
%        \infer[\tr]{Y \mid Z \vdash_{\F} (X \lolli Y) \ot Z}{
%          \infer[\lright]{Y \mid \quad \vdash_{\RI} X \lolli Y}{
%            \deduce{Y \mid X \vdash_{\RI} Y}{??}
%          }
%          &
%          \infer[\mathsf{sw}]{- \mid Z \vdash_{\RI} Z}{
%            \infer[\pass]{- \mid Z \vdash_{\Pass} Z}{
%              \infer[\mathsf{sw}]{Z \mid \quad \vdash_{\LI} Z}{
%                \infer[\ax]{Z \mid \quad \vdash_{\F} Z}{}
%              }
%            }
%          }
%        }
%      }
%    }
%  }
%\end{displaymath}
%It fails to find a proof of $X \lolli Y \mid Z \vdash_{\RI} (X \lolli Y) \ot Z$ because we don't have a rule to prove ${-} \mid \quad \vdash_{\RI} X$ when $X$ is atomic.
%We also could not prove sequent $Y \mid X \vdash_{\RI} Y$ since there is no primitive or admissible left weakening rule in our system.
%The problem in quick solution of case 1 arises when there are some stoup related formulae packed in succedent.
%If we insist to decompose stoup before succedent then it is impossible to finish proof search.
%The other way around is similar, i.e. some succedent related formulae are packed in stoup.

\subsection{A Focused System with Tag Annotations}\label{sec:tag}

%However, solution for case 2 inspires us to come up with a uniform solution.
In order to eliminate the non-determinism of type 1 between $\pass$ and $\tr$, we need to restrict applications of $\pass$ after an application of $\tr$.
One way to achieve this is by forcing such an application of $\pass$ to move the leftmost formula to the stoup only if such formula occurrence is \emph{new}, in the sense that it was not already present in the context before the $\tr$ application. For example, with this restriction in place, the application of $\pass$ in the 2nd derivation of (\ref{eq:passtr}) would be invalid, since the formula $X$ was already present in context before the application of $\tr$.

Analogously, the non-determinism of type 2 between $\lleft$ and $\tr$ can be eliminated by restricting applications of $\lleft$ after an application of $\tr$. This can be achieved by forcing the subsequent application of $\lleft$ to split the context in two parts $\Gamma,\Delta$ in such a way that $\Gamma$, i.e. the context of the first premise, necessarily contains some \emph{new} formula not occurring in the context before the first $\tr$ application. Under this restriction, the application of $\lleft$ in the 2nd derivation of (\ref{eq:llefttr}) would become invalid, since all formulae in $\Gamma$ are already present in context before the application of $\tr$.

One way to distinguish between old and new formulae occurrences in the above cases is by marking with a \emph{tag} $\bullet$ each new formula appearing in context during the building of a focused derivation. We christen a formula occurrence ``new'' whenever it is moved from the succedent to the context via an application of the right implication rule $\lright$. In order to remember when we are building a derivation of a sequent arising as the first premise of $\tr$, in which the distinction between old and new formula is relevant, we mark such sequents with a tag $\bullet$ as well.
%In other words, the first premise of  $\tr$ in (\ref{eq:naive}) would be replace by a sequent $T \mid \Gamma \vdash_\RI^\bullet A$
%In the complicated focused system, sequents can also potentially be annotated with an extra superscript annotation $\bullet$, called a \emph{tag}. Tags are a technical mechanism for keeping track of new formulae appearing in the context after the application of the right implication rule. This, as we will thorougly discuss later, allows to control the reduction of non-deterministic choices during proof search, in particular resolving the possible choices arising from the permutative conversions of Figure \ref{fig:circeq}.
More generally, we write $S \mid \Gamma \xvdash_{ph} C$ for a sequent that can potentially be tagged, i.e. the turnstile could be of the form $\vdash_{ph}^{\bullet}$ or $\vdash_{ph}$, for all $ph \in \{ \RI,\LI,\Pass,\F\}$. This implies that there are a total of 8 sequent phases, corresponding to the possible combinations of 4 subscript phases with the tagged/untagged state.
%A tag can either be \emph{black} $\bullet$, with corresponding turnstile symbol $\vdash_{ph}^{\bullet}$, or \emph{white} $\circ$, in which case we write $\vdash_{ph}^\circ$ or simply $\vdash_{ph}$, where $ph \in \{ \RI,\LI,\Pass,\F\}$. This implies that there are a total of 8 sequent phases, corresponding to the possible combinations of 4 subscript phases with the 2 tags.
In tagged sequents  $S \mid \Gamma \vdash_{ph}^{\bullet} C$, formulae in the context $\Gamma$ are also allowed to be tagged, i.e. they can be of the form $A^\bullet$ or $A$. Given a context $\Gamma$ that may contain tagged formulae, we write $\Gamma^{\circ}$ for the same context where all tags have been removed from the formulae in it. All formulae in an untagged sequent $S \mid \Gamma \vdash_{ph} C$ must be untagged.

Derivations in the focused sequent calculus with tag annotations are generated by the rules
%\begin{defn}
%  The \emph{focused sequent calculus} for \SkNMILL\ has four phases($\RI , \LI , \Pass$, and $\F$) with  special annotations $\bullet$(tag) on $\vdash$ so \SkNMILL\ defines a skew monoidal closed category \FSkMCC($\mathsf{At}$).
\begin{equation}\label{eq:focus}
%  \def\arraystretch{2.5}
  \begin{array}{lc}
    \text{(right invertible)} & %\\[-4pt] &
    \proofbox{
      \infer[\lright]{S \mid \Gamma \vdash^{x}_{\RI} A \lolli B}{S \mid \Gamma , A^{x} \vdash^{x}_{\RI} B}
    \qquad
    \infer[\LI 2 \RI]{S \mid \Gamma \vdash^{x}_{\RI} P}{S \mid \Gamma \vdash^{x}_{\LI} P}
    }
%  \end{displaymath}
    %  \begin{displaymath}
    \\[6pt]
    \text{(left invertible)} & %\\[-4pt] &
    \proofbox{
      \infer[\unitl]{\I \mid \Gamma \vdash_{\LI} P}{{-} \mid \Gamma \vdash_{\LI} P}
    \qquad
    \infer[\tl]{A \ot B \mid \Gamma \vdash_{\LI} P}{A \mid B , \Gamma \vdash_{\LI} P}
    \qquad
    \infer[\Pass 2 \LI]{T \mid \Gamma \xvdash_{\LI} P}{T \mid \Gamma \xvdash_{\Pass} P}
    }
%  \end{displaymath}
    %  \begin{displaymath}
    \\
    \text{(passivation)} & \\ %&
    %\hspace{-1.7cm}
   \multicolumn{2}{c}{
    \infer[\pass]{{-} \mid A^{x} , \Gamma \xvdash_{\Pass} P }{
      A\mid \Gamma^{\circ} \vdash_{\LI} P
    }
    \quad
%    \\[6pt]
%
    \infer[\F 2 \Pass]{T \mid \Gamma \xvdash_{\Pass} P}{
      T \mid \Gamma^\circ \vdash_{\F} P &
      T = {-} \vee T = X
    }
    \quad
    \infer[\F 2 \Pass_{{\lolli}}]{T \mid \Gamma \xvdash_{\Pass} P}{
      T \mid \Gamma \xvdash_{\F} P &
      T = A \lolli B
    }
    }
%  \end{displaymath}
    %  \begin{displaymath}
    \\[6pt]
    \text{(focusing)} &    %\\[-4pt] &
    \proofbox{\infer[\ax]{X \mid \quad \vdash_{\F} X}{}
    \qquad
    \infer[\unitr]{{-} \mid \quad \vdash_{\F} \I}{}
    }
    \\[6pt]
    \multicolumn{2}{c}{
    \infer[\tr]{T \mid \Gamma , \Delta \xvdash_{\F} A \ot B}{
      T \mid \Gamma^{\circ} \vdash^{\bullet}_{\RI} A
      &
      {-} \mid \Delta^{\circ} \vdash_{\RI} B
    }
    \qquad
    \infer[\lleft]{A \lolli B \mid \Gamma , \Delta \xvdash_{\F} P}{
      {-} \mid \Gamma^{\circ} \vdash_{\RI} A
      &
      B \mid \Delta^{\circ} \vdash_{\LI} P
      &
      x = \bullet \supset \bullet \in \Gamma
    }
    }
%  \end{displaymath}
%  \begin{displaymath}
  \end{array}
\end{equation}
%\end{defn}
The side condition in rule $\lleft$ reads: if $x = \bullet$, there exists an occurrence of a tagged formula $D^\bullet$ in $\Gamma$.
%The side condition in rule $\F 2\Pass$ reads: if the stoup $T$ is empty or an atomic formula, then $y$ is empty, i.e. the premise is sequent $T \mid \Gamma \vdash P$; if $T$ is an implication, then $y = x$.

%We explain the rules of the focused sequent calculus from the perspective of bottom-up proof search. We start by analyizing the proof search of an untagged sequent $S \mid \Gamma \vdash_{\RI} C$, by pretending that the tag annotations are not present and forgetting about all the side conditions related to tags.
%One important thing is that even though we have tagged suquents in a proof, but the end sequent should keep tag free.

The rules in (\ref{eq:focus}), when stripped of all the tags, are equivalent to the rules in the na{\"i}ve calculus (\ref{eq:naive}). When building a derivation of an untagged sequent $S \mid \Gamma \vdash_\RI A$, the only possible way to enter a tagged phase is via an application of the $\tr$ rule, so that sequents with turnstile marked $\vdash_{ph}^\bullet$ denote the fact that we are performing proof search for the first premise of an $\tr$ inference (and the stoup is negative).
The search for a proof of a tagged sequent $T \mid \Gamma^\circ \vdash^\bullet_\RI A$ proceeds as follows:
\begin{itemize}
\item[($\vdash^\bullet_\RI$)] We eagerly apply the right invertible rule $\lright$ with the goal of reducing $A$ to a positive formula $P$. All the formulae moved to the right end of the context are ``new'', and therefore are marked with $\bullet$.
  When the succedent formula becomes positive, we move to the tagged $\LI$ phase via $\LI2\RI$.
  %keeping the same tag $x$.
\item[($\vdash^\bullet_\LI$)] Since $T$ is a negative stoup, we can only move to the tagged $\Pass$ phase via $\Pass2\LI$.
  %keeping the same tag $x$. Notice that  the formula $B$ in the premise of rule $\tl$ does not get marked with a tag.
  %In this phase we do not need to enforce the order between $\unitl$ and $\tl$ applicaitons because they are not exchangeable.
\item[($\vdash^\bullet_\Pass$)] We have the possibility of applying the $\pass$ rule and move the leftmost formula $A$ in the context to the stoup, but only when this formula is marked by $\bullet$. This restriction makes it possible to remove non-determinism of type 1. Afterwards, we strip the context of all tags and jump to untagged $\LI$ phase. If we do not (or cannot) apply $\pass$, we move to phase $\F$  in two different ways, depending on the status of $T$. If $T$ is either empty or atomic, we strip the context of the tags and move to untagged $\F$ phase via $\F2\Pass$. If $T$ is an implication, we move to black $\F$ phase via $\F2\Pass_\lolli$. In the latter case, the tags are preserved for restricting the future possible applications of $\lleft$.
\item[($\vdash^\bullet_\F$)] We can apply only $\tr$ or $\lleft$. If we apply $\tr$, we remove all tags from the context $\Gamma$ and move the first premise to the tagged $\RI$ phase again. The tags are removed from the contexts in order to not mix the tagged formulae that have appeared in context so far with the ``new'' formulae that may appear in the future. The most interesting case is $\lleft$, which can only be applied if $\Gamma$ contains at least one tagged formula. This side condition implements the restriction allowing the elimination of non-determinism of type 2. All the premises of $\lleft$ are stripped of their tags.
\end{itemize}

%In this sense, we can add some marks on left premise of $\tr$ applications.
%Specifically, the left premise goes to a special black phase where sequents can also potentially be annotated with an extra superscript annotation $\bullet$, called a \emph{tag}. Tags are a technical mechanism for keeping track of new formulae appearing in the context after the application of the right implication rule.
%Under this tag setting $\pass$ can be applied only if the passivated formula is tagged, which means that it comes from $\lright$ docomposition.
%In particular, it means that the passivated formula was packed in succedent in previous $\tr$ decomposition which is an analogous situation of case 1.
%Accoding to this setting, we can prioritize $\lleft$ than $\tr$ and keep provability.
%We achieve this goal by restricting the $\lleft$ applications in black phase.
%Specifically, we can decompose $\lleft$ in black phase only if there is some black formula in left context $\Gamma$ (means that $\Gamma$ goes to left premise after decomposition).
%Under this framework, we prioritize $\lleft$ than $\tr$ to eliminate non-determinacy but also keep provablity of our focused system.


%Since both rules $\tr$ and $\lleft$ appear in the same phase $\F$, and both rules can be applicable in some cases (see the last equation in Figure \ref{fig:circeq}.
%  Here we have special resrictions on $\tl$ and $\lleft$.
%  In general, we prefer to decompose $\lolli$ in stoup prior then $\ot$ in conclusion.
%  However, if there are some formula are packed into conclusion, then whole bottom-up proof strategy fails.
%  We will see comparison between involved and naive focused system later.
%  For rule $\tr$, we let its left and right premises back to phase $\RI$ because $A$ and $B$ could be negative formulas.
%  Especially, the left premise becomes a tagged sequent.
%  In a $\lleft$ application, if conclusion sequent is tagged, then at least exists a formula $F$ is black in the context of left premise.
%  Remembering that we prefer $\lleft$ prior to $\tr$, so if there is any $\tr$ before $\lleft$, then we have to ensure that we cannot do $\lleft$ first.
%  Black tags produced by $\lright$ play essential roles here because if there is no black formula in $\Gamma$, then it implies that we cannot do $\lleft$ after $\tr$.
%  In this situation, we must decompose $\lolli$ in stoup prior than $\ot$ in conclusion.

The employment of tag annotations eliminate the two types of non-determinism. For example, only one of the two derivations in (\ref{eq:passtr}) is valid using the rules in (\ref{eq:focus}), and similarly for (\ref{eq:llefttr}).
%is valid using the rules in (\ref{eq:focus}), removing non-determinism of type 2:
%removing non-determinism of type 1:
%given a sequent $A \lolli B \mid \Gamma , \Delta , \Lambda \vdash_{\RI} C \ot D$ and supposed that $B$ is irreducible, $C = A' \lolli B'$,
%  we can construct a proof:
\vspace{-.3cm}
\begin{displaymath}
  \begin{array}{cc}
%    \infer[\mathsf{sw}]{{-} \mid X , \Gamma , \Delta \vdash_{\RI} P \ot C}{
      \infer[\pass]{{-} \mid X , \Gamma , \Delta \vdash_{\Pass} P \ot C}{
        \infer[\mathsf{sw}]{X \mid \Gamma , \Delta \vdash_{\LI} P \ot C}{
          \infer[\tr]{X \mid \Gamma , \Delta \vdash_{\F} P \ot C}{
            \infer{X \mid \Gamma \vdash^{\bullet}_{\RI} P}{
              \deduce{X \mid \Gamma \vdash^{\bullet}_{\LI} P}{f}
              }
            &
            \deduce{{-} \mid \Delta \vdash_{\RI} C}{g}
          }
        }
      }
%    }
    &
    \infer[\mathsf{sw}]{{-} \mid X , \Gamma , \Delta \vdash_{\Pass} P \ot C}{
      \infer[\tr]{{-} \mid X , \Gamma , \Delta \vdash_{\F} P \ot C}{
        \infer[\mathsf{sw}]{{-} \mid X , \Gamma \vdash^{\bullet}_{\RI} P}{
          \deduce{{-} \mid X , \Gamma \vdash^{\bullet}_{\Pass} P}{??}
        }
        &
        \deduce{{-} \mid \Delta \vdash_{\RI} C}{g}
      }
    }
    \\
    (\text{same derivation as in (\ref{eq:passtr})})
    &
    (\text{$\pass$ not applicable since $X$ is not tagged})
    \\[2pt]
%    \infer[\mathsf{sw}]{A \lolli X \mid \Gamma , \Delta , \Lambda \vdash_{\RI} P \ot D}{
      \infer[\lleft]{A \lolli X \mid \Gamma , \Delta , \Lambda \vdash_{\F} P \ot D}{
        \deduce{{-} \mid \Gamma \vdash_{\RI} A}{f}
        &
        \infer[\mathsf{sw}]{X \mid \Delta , \Lambda \vdash_{\LI} P \ot D}{
          \infer[\tr]{X \mid \Delta , \Lambda \vdash_{\F} P \ot D}{
            \infer[\mathsf{sw}]{X \mid \Delta \vdash^{\bullet}_{\RI} P}{
              \deduce{X \mid \Delta \vdash^{\bullet}_{\LI} P}{g}
              }
            &
            \deduce{{-} \mid \Lambda \vdash_{\RI} D}{h}
          }
        }
      }
%    }
    &
%   \infer[\mathsf{sw}]{A \lolli X \mid \Gamma , \Delta , \Lambda \vdash_{\RI} P \ot D}{
      \infer[\tr]{A \lolli X \mid \Gamma , \Delta , \Lambda \vdash_{\F} P \ot D}{
        \infer[\mathsf{sw}]{A \lolli X \mid \Gamma , \Delta \vdash^{\bullet}_{\RI} P}{
          \deduce{A \lolli X \mid \Gamma , \Delta \vdash^{\bullet}_{\F} P}{??}
        }
%            \infer[\lleft]{A \lolli X \mid \Gamma , \Delta , \vdash^{\bullet}_{\F} P}{
%              \deduce{{-} \mid \Gamma , \Delta , A' \vdash_{\RI} A}{??}
%              &
%              \deduce{X \mid \quad \vdash_{\LI} X'}{??}
%            }
%          }
%        }
        &
        \deduce{{-} \mid \Lambda \vdash_{\RI} D}{h}
      }
%    }
    \\
    (\text{same derivation as in (\ref{eq:llefttr})})
    &
    (\text{$\lleft$ not applicable since $\Gamma$ is tag-free})
   \end{array}
  \end{displaymath}
%  However, the other way around(decompose $\ot$ prior to $\lolli$) is impossible.
%  Because the sequent is black, if we want to decompose $A \lolli B$, we have to decompose $A' \lolli B'$ first to obtain $A^{\bullet}$ in context then send $\Gamma , \Delta , A'$ to left premise of $\lleft$ application.
%  In the end, the proof tree cannot close:
 % \begin{displaymath}
 % \end{displaymath}
%  The situation is worse if $C$ is positive, we cannot produce tags from $\lright$ application to ensure applicability of $\lleft$, so the whole derivation gets stuck and cannont close.

%  We can solve non-determinacy case 2 by following construction.
%  Given a sequent ${-} \mid A , \Gamma , \Delta \vdash_{\RI} B \ot C$, there is only one proof can be constructed in tagged focused system.

 % The extra restriction on sequents and formulae imposed on the rules in (\ref{eq:focus}) do not reduce provability, e.g., the sequents $X \lolli Y \mid Z \vdash_{\RI} (X \lolli Y) \ot Z$, whose proof requires the application of $\tr$ before $\lleft$,
 % and $X \lolli (Y \ot Z) \mid X \vdash_\F Y \ot Z$, where $\lleft$ must appear below $\tr$ in the proof tree, are both derivable.
 The extra restriction on sequents and formulae imposed on the rules in (\ref{eq:focus}) do not reduce provability, e.g., the sequents ${-} \mid Y \vdash_{\F} (X \lolli X) \ot Y$, $X \lolli Y \mid Z \vdash_{\RI} (X \lolli Y) \ot Z$, whose proof requires the application of $\tr$ before $\lleft$,
 and $X \lolli (Y \ot Z) \mid X \vdash_\F Y \ot Z$, where $\lleft$ must appear below $\tr$ in the proof tree, are all derivable.
 \begin{displaymath}
 \small
   \begin{array}{cc}
   \proofbox{
     \infer[\tr]{X \lolli Y \mid Z \vdash_{\F} (X \lolli Y) \ot Z}{
      \infer[\lright]{X \lolli Y \mid \quad \vdash^{\bullet}_{\RI} X \lolli Y}{
        \infer[\mathsf{sw}]{X \lolli Y \mid X^{\bullet} \vdash^{\bullet}_{\RI} Y}{
          \infer[\lleft]{X \lolli Y \mid X^{\bullet} \vdash^{\bullet}_{\F} Y}{
            \infer[\mathsf{sw}]{{-} \mid X \vdash_{\RI} X}{
              \infer[\pass]{{-} \mid X \vdash_{\Pass} X}{
                \infer[\mathsf{sw}]{X \mid \quad \vdash_{\LI} X}{
                  \infer[\ax]{X \mid \quad \vdash_{\F} X}{}
                }
              }
            }
            &
            \infer[\mathsf{sw}]{Y \mid \quad \vdash_{\LI} Y}{
              \infer[\ax]{Y \mid \quad \vdash_{\F} Y}{}
            }
          }
        }
      }
      &
      \infer[\mathsf{sw}]{{-} \mid Z \vdash_{\RI} Z}{
        \infer[\pass]{{-} \mid Z \vdash_{\Pass} Z}{
          \infer[\mathsf{sw}]{Z \mid \quad \vdash_{\LI} Z}{
            \infer[\ax]{Z \mid \quad \vdash_{\F} Z}{}
          }
        }
      }
     }
     \quad
     \infer[\lleft]{X \lolli (Y \ot Z) \mid X \vdash_{\F} Y \ot Z}{
      \infer[\mathsf{sw}]{{-} \mid X \vdash_{\RI} X}{
        \infer[\pass]{{-} \mid X \vdash_{\Pass} X}{
          \infer[\mathsf{sw}]{X \mid \quad \vdash_{\LI} X}{
            \infer[\ax]{X \mid \quad \vdash_{\F} X}{}
          }
        }
      }
      &
      \infer[\tl]{Y \ot Z \mid \quad \vdash_{\LI} Y \ot Z}{
        \infer[\mathsf{sw}]{Y \mid Z \vdash_{\LI} Y \ot Z}{
          \infer[\tr]{Y \mid Z \vdash_{\F} Y \ot Z}{
            \infer[\mathsf{sw}]{Y \mid \quad \vdash_{\RI}^{\bullet} Y}{
              \infer[\ax]{Y \mid \quad \vdash_{\F} Y}{}
            }
            &
            \infer[\mathsf{sw}]{{-} \mid Z \vdash_{\RI} Z}{
              \infer[\pass]{{-} \mid Z \vdash_{\Pass} Z}{
                \infer[\mathsf{sw}]{Z \mid \quad \vdash_{\LI} Z}{
                  \infer[\ax]{Z \mid \quad \vdash_{\F} Z}{}
                }
              }
            }
          }
        }
      }
     }
     }
     \\
     \proofbox{
     \infer[\tr]{{-} \mid Y \vdash_{\F} (X \lolli X) \ot Y}{
      \infer[\lright]{{-} \vdash \quad \vdash^{\bullet}_{\RI} X \lolli X}{
        \infer[\mathsf{sw}]{{-} \mid X^{\bullet} \vdash^{\bullet}_{\RI} X}{
          \infer[\pass]{{-} \mid X^{\bullet} \vdash^{\bullet}_{\Pass} X}{
            \infer[\mathsf{sw}]{X \mid \quad \vdash_{\LI} X}{
              \infer[\ax]{X \mid \quad \vdash_{\F} X}{}
            }
          }
        }
      }
      &
      \infer[\mathsf{sw}]{{-} \mid Y \vdash_{\RI} Y}{
        \infer[\pass]{{-} \mid Y \vdash_{\Pass} Y}{
          \infer[\mathsf{sw}]{Y \mid \quad \vdash_{\LI} Y}{
            \infer[\ax]{Y \mid \quad \vdash_{\F} Y}{}
          }
        }
      }
     }
     }
   \end{array}
   \normalsize
 \end{displaymath}
%  \begin{displaymath}
%    \infer[\mathsf{sw}]{X \lolli Y \mid Z \vdash_{\RI} (X \lolli Y) \ot Z}{
%      \infer[\tr]{X \lolli Y \mid Z \vdash_{\F} (X \lolli Y) \ot Z}{
%        \infer[\lright]{X \lolli Y \mid \quad \vdash^{\bullet}_{\RI} X \lolli Y}{
%          \infer[\mathsf{sw}]{X \lolli Y \mid X^{\bullet} \vdash_{\RI} Y}{
%            \infer[\lleft]{X \lolli Y \mid X^{\bullet} \vdash_{\F} Y}{
%              \infer[\mathsf{sw}]{{-} \mid X \vdash_{\RI} X}{
%                \infer[\pass]{{-} \mid X \vdash_{\Pass} X}{
%                  \infer[\mathsf{sw}]{X \mid \quad \vdash_{\LI} X}{
%                    \infer[\ax]{X \mid \quad \vdash_{\F} X}{}
%                  }
%                }
%              }
%              &
%              \infer[\mathsf{sw}]{Y \mid \quad \vdash_{\LI} Y}{
%                \infer[\ax]{Y \mid \quad \vdash_{\F} Y}{}
%              }
%            }
%          }
%        }
%        &
%        \infer[\mathsf{sw}]{{-} \mid Z \vdash_{\RI} Z}{
%          \infer[\pass]{{-} \mid Z \vdash_{\Pass} Z}{
%            \infer[\mathsf{sw}]{Z \mid \quad \vdash_{\LI} Z}{
%              \infer[\ax]{Z \mid \quad \vdash_{\F} Z}{}
%            }
%          }
%        }
%      }
%    }
%  \end{displaymath}
%\end{itemize}

There are still two types of essential non-determinism in the tagged focused system.
We say these non-determinism cases are essential because they capture the fact that it possibly exists multiple distinct derivations of a seqeunt in \SkNMILL:
\begin{enumerate}[i.]
  \item in phase $\Pass$, when the stoup is empty, whether to apply $\pass$ or $\F2\Pass$, e.g., the sequent $X \mid \I \ot Y \vdash_{\F} X \ot (\I \ot Y)$ has two distinct derivations in the tagged focused system as well as in \SkNMILL.
  \begin{equation*}
  \small
    \begin{array}{cc}
    \infer[\tr]{X \mid \I \ot Y \vdash_{\F} X \ot (\I \ot Y)}{
    \infer[\mathsf{sw}]{X \mid \quad \vdash^{\bullet}_{\RI} X}{
      \infer[\ax]{X \mid \quad \vdash_{\F} X}{}
    }
      &
      \infer[\mathsf{sw}]{{-} \mid \I \ot Y \vdash_{\RI} \I \ot Y}{
        \infer[\pass]{{-} \mid \I \ot Y \vdash_{\Pass} \I \ot Y}{
          \infer[\tl]{\I \ot Y \mid \quad \vdash_{\LI} \I \ot Y}{
            \infer[\unitl]{\I \mid Y \vdash_{\LI} \I \ot Y}{
              \infer[\mathsf{sw}]{{-} \mid Y \vdash_{\LI} \I \ot Y}{
                \infer[\tr]{{-} \mid Y \vdash_{\F} \I \ot Y}{
                  \infer[\mathsf{sw}]{{-} \mid \quad \vdash^{\bullet}_{\RI} \I}{
                    \infer[\unitr]{{-} \mid \quad \vdash_{\F} \I}{}
                  }
                  &
                  \infer[\mathsf{sw}]{{-} \mid Y \vdash_{\RI} Y}{
                    \infer[\pass]{{-} \mid Y \vdash_{\Pass} Y}{
                      \infer[\mathsf{sw}]{Y \mid \quad \vdash_{\LI} Y}{
                        \infer[\ax]{Y \mid \quad \vdash_{F} Y}{}
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    &
    \infer[\tr]{X \mid \I \ot Y \vdash_{\F} X \ot (\I \ot Y)}{
      \infer[\mathsf{sw}]{X \mid \quad \vdash^{\bullet}_{\RI} X}{
        \infer[\ax]{X \mid \quad \vdash_{\F} X}{}
      }
      &
      \infer[\mathsf{sw}]{{-} \mid \I \ot Y \vdash_{\RI} \I \ot Y}{
        \infer[\tr]{{-} \mid \I \ot Y \vdash_{\F} \I \ot Y}{
          \infer[\mathsf{sw}]{{-} \mid \quad \vdash^{\bullet}_{\RI} \I}{
            \infer[\unitr]{{-} \mid \quad \vdash_{\F} \I}{}
          }
          &
          \infer[\mathsf{sw}]{{-} \mid \I \ot Y \vdash_{\RI} Y}{
            \infer[\pass]{{-} \mid \I \ot Y \vdash_{\Pass} Y}{
              \infer[\mathsf{sw}]{\I \ot Y \mid \quad \vdash_{\LI} Y}{
                \infer[\tl]{\I \ot \mid \quad \vdash_{\LI} Y}{
                  \infer[\unitl]{\I \mid Y \vdash_{\LI}}{
                    \infer[\mathsf{sw}]{{-} \mid Y \vdash_{\LI} Y}{
                      \infer[\pass]{{-} \mid Y \vdash_{\Pass} Y}{
                        \infer[\mathsf{sw}]{Y \mid \quad \vdash_{\LI} Y}{
                          \infer[\ax]{Y \mid \quad \vdash_{\F} Y}{}
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    \end{array}
    \normalsize
  \end{equation*}
  \item in phase $\F$, when in the middle of the context there are closed formulae (i.e., formulae made of $\I$ and $\ot$ only), the succedent formula is $A \ot B$, and the rule $\tr$ is to be applied, we can split the context freely.
  For example, the sequent $X \mid \I , Y \vdash_{\F} (X \ot \I) \ot Y$ has two distinct derivations.
  \begin{equation*}
  \small
    \begin{array}{cc}
      \infer[\tr]{X \mid \I , Y \vdash_{\F} (X \ot \I) \ot Y}{
       \infer[\mathsf{sw}]{X \mid \I \vdash^{\bullet}_{\RI} X \ot \I}{
         \infer[\tr]{X \mid \I \vdash_{\F} X \ot \I}{
           \infer[\mathsf{sw}]{X \mid \quad \vdash^{\bullet}_{\RI} X}{
             \infer[\ax]{X \mid \quad \vdash_{\F} X}{}
           }
           &
           \infer[\mathsf{sw}]{{-} \mid \I \vdash_{\RI} \I}{
             \infer[\pass]{{-} \mid \I \vdash_{\Pass} \I}{
               \infer[\unitl]{\I \mid \quad \vdash_{\LI} \I}{
                 \infer[\mathsf{sw}]{{-} \mid \quad \vdash_{\LI} \I}{
                   \infer[\unitr]{{-} \mid \quad \vdash_{\F} \I}{}
                 }
               }
             }
           }
         }
       }
       &
       \infer[\mathsf{sw}]{{-} \mid Y \vdash_{\RI} Y}{
         \infer[\pass]{{-} \mid Y \vdash_{\Pass} Y}{
           \infer[\mathsf{sw}]{Y \mid \quad \vdash_{\LI} Y}{
             \infer[\ax]{Y \mid \quad \vdash_{\F} Y}{}
           }
         }
       }
      }
      &
      \infer[\tr]{X \mid \I , Y \vdash_{\F} (X \ot \I) \ot Y}{
       \infer[\mathsf{sw}]{X \mid \quad \vdash^{\bullet}_{\RI} X \ot \I}{
         \infer[\tr]{X \mid \quad \vdash_{\F} X \ot \I}{
           \infer[\mathsf{sw}]{X \mid \quad \vdash^{\bullet}_{\RI} X}{
             \infer[\ax]{X \mid \quad \vdash_{\F} X}{}
           }
           &
           \infer[\mathsf{sw}]{{-} \mid \quad \vdash_{\RI} \I}{
             \infer[\ax]{{-} \mid \quad \vdash_{\F} \I}{}
           }
         }
       }
       &
       \infer[\mathsf{sw}]{{-} \mid \I , Y \vdash_{\RI} Y}{
         \infer[\pass]{{-} \mid \I , Y \vdash_{\Pass} Y}{
           \infer[\unitl]{\I \mid Y \vdash_{\LI} Y}{
             \infer[\mathsf{sw}]{{-} \mid Y \vdash_{\LI} Y}{
               \infer[\pass]{Y \mid \quad \vdash_{\Pass} Y}{
                 \infer[\mathsf{sw}]{Y \mid \quad \vdash_{\LI} Y}{
                   \infer[\ax]{Y \mid \quad \vdash_{\F} Y}{}
                 }
               }
             }
           }
         }
       }
      }
    \end{array}
    \normalsize
  \end{equation*}
\end{enumerate}
% In the latter case, only those choices where $\mid T \mid , \mid \Gamma \mid = \mid A \mid$ and $\mid \Delta \mid = \mid B \mid$ can possibly lead to a complete derivation;
% we write $\mid \quad \mid$ for the frontier of atoms in a formula, an optional formula, and a list of formulae.
% But there can be multiple such choices if in the middle of the context there are closed formulae (i.e., formulae made of $\I$ and $\ot$ only): those can be freely split between $\Gamma$ and $\Delta$.

%This fact shows that in tagged focused system, we cannot permute $\tr$ and $\lleft$ applications arbitrarily.
%In this sense, two equivalent proofs in \SkNMILL\ become identical in focused calculus.
 \begin{theorem}
   The focused sequent calculus is sound and complete wrt.\ the  sequent calculus of Section \ref{sec2}: there is a bijective correspondence between the set of derivations of $S \mid \Gamma \vdash A$ quotiented by $\circeq$ and the set of derivations of $S \mid \Gamma \vdash_\RI A$.
 \end{theorem}
Soundness is immediate: there exist functions $\mathsf{emb}_{ph} : S \mid \Gamma \vdash^x_{ph} A \to S \mid \Gamma \vdash A$, for all $ph \in \{\RI,\LI,\Pass, \F \}$, which simply erase all phase annotations and tags. Completeness follows from the fact that the following rules are all admissible: % here not only can prove every sequent in \SkNMILL (\SkNMILL and tagged focused system are equivalent) but also without producing redundant non-determinacy.
%Moreover, not only $\tr$ and $\lleft$ equivalent case becomes identical in focused system, but any other equivalent cases hold the same fact.
%We can substantiate equivalence between \SkNMILL and tagged focused calculus by following results.
%\begin{lemma}\label{AdmissibleInRI}
%  Following rules are admissible in tagged focused system:
\vspace{-.1cm}
\begin{equation}\label{eq:admis}
  \begin{array}{c}
    \hspace{-3.9pt}
    \infer[\unitl^{\RI}]{\I \mid \Gamma \vdash_{\RI} C}{{-} \mid \Gamma \vdash_{\RI} C}
    \quad
    \infer[\tl^{\RI}]{A \mid B, \Gamma \vdash_{\RI} C}{A \mid B, \Gamma \vdash_{\RI} C}
    \quad
    \infer[\pass^{\RI}]{{-} \mid \Gamma \vdash_{\RI} C}{A \mid \Gamma \vdash_{\RI} C}
    \quad
    \infer[\ax^{\RI}]{A \mid \quad \vdash_{\RI} A}{}
    \quad
    \infer[\unitr^{\RI}]{{-} \mid \quad \vdash_{\RI} \I}{}
\\[6pt]
    \infer[\lleft^{\RI}]{A \lolli B \mid \Gamma , \Delta \vdash_{\RI} C}{
    {-} \mid \Gamma \vdash_{\RI} A
    &
    B \mid \Delta \vdash_{\RI} C
    }
    \qquad
    \infer[\tr_{\Gamma'}^{\RI}]{S \mid \Gamma , \Delta \vdash_{\RI} \ldbc \Gamma' \mid A \rdbc_{\lolli} \ot B}{
      S \mid \Gamma , \Gamma' \vdash_{\RI} A
      &
      {-} \mid \Delta \vdash_{\RI} B
    }
  \end{array}
\end{equation}
%\end{lemma}
The interesting one is $\tr_{\Gamma'}^{\RI}$. The tensor right rule $\tr^\RI$, with premises and conclusion in phase $\RI$, is an instance of the latter with empty $\Gamma'$.
Without this generalization including the extra context $\Gamma'$, one quickly discovers that finding a proof of $\tr^\RI$, proceeding by induction on the structure of the derivation of the first premise, is not possible when this derivation ends with an application of $\lright$:
%The generalization is necessary for making the inductive hypothesis strong enough and make our proof smoothly.
%For example, considering following proof tree, if we invoke simple version of $\tr$ in phase $\RI$, then we cannot proof its admissibility:
\vspace{-.3cm}
\begin{displaymath}
  \proofbox{
    \infer[\tr^{\RI}]{S \mid \Gamma , \Delta \vdash_{\RI} (A' \lolli B') \ot B}{
    \infer[\lright]{S \mid \Gamma \vdash_{\RI} A' \lolli B'}{
      \deduce{S \mid \Gamma , A' \vdash_{\RI} B'}{f}
    }
    &
    \deduce{{-} \mid \Delta \vdash_{\RI} B}{g}
    }
    } = \quad ??
\end{displaymath}
The inductive hypothesis applied to $f$ and $g$ would produce a derivation of the wrong sequent. The use of $\Gamma'$ in the generalized rule $\tr_{\Gamma'}^{\RI}$ is there to fix precisely this issue.
%In this case, we cannot permute $\tr^{\RI}_s$ up to use inductive hypothesis.
%Therefore we need to have a stronger version of $\tr$ which performs $\tr$ and $\lright$ in the same time.
%There is no generality loss because we can always take $\Gamma'$ as empty then reduce to simple $\tr$.

The admissibility of the rules in (\ref{eq:admis}) allows the construction of a function $\mathsf{focus} : S \mid \Gamma \vdash A \to S \mid \Gamma \vdash_\RI A$, replacing applications of each rule in (\ref{eq:seqcalc}) with inferences by the corresponding admissible focused rule in phase $\RI$.
%satisfying $\mathsf{focus}\;f = \mathsf{focus}\;g$ whenever $f \circeq g$. In turns, the existence of such function $\mathsf{focus}$ is equivalent to the
%On the other hand, we can define a function $\mathsf{focus}$ to map each derivation in cut-free sequent calculus to a derivaiton in focused calculus because lemma \ref{AdmissibleInRI} holds.
%Specifically, for each derivation in cut-free sequent calculus, function $\mathsf{focus}$ adds phase label $\RI$ on $\vdash$ and rename each rule into its $\RI$ version.
It is possible to prove that the function $\mathsf{focus}$ maps  $\circeq$-equivalent derivations in the sequent calculus for \SkNMILL\ to syntactically identical derivations in focused sequent calculus. One can also show that $\mathsf{focus}$ is the inverse of $\mathsf{emb}_\RI$, i.e. $\mathsf{focus}\;(\mathsf{emb}_\RI \;f) = f$ for all $f : S \mid \Gamma \vdash_\RI A$ and $\mathsf{emb}_\RI\;(\mathsf{focus}\;g) \circeq g$ for all $g : S \mid \Gamma \vdash A$. In other words, each $\circeq$-equivalence class in the sequent calculus corresponds uniquely to a single derivation in the focused sequent calculus.

The focused sequent calculus solves the \emph{coherence problem} for skew monoidal closed categories.
As proved in Theorem \ref{thm:unique}, the sequent calculus for \SkNMILL\ has an underlying category $\FSkMCC(\mathsf{At})$, which is the free skew monoidal closed category on the set $\mathsf{At}$. The coherence problem is the problem of deciding whether two parallel maps in $\FSkMCC(\mathsf{At})$ are equal. %wrt.\ the equational theory of skew monoidal closed categories.
This is equivalent to deciding whether two derivations $f,g : S \mid \Gamma \vdash A$ are in the same $\circeq$-equivalence class. But that in turn is the same as deciding whether $\mathsf{focus}\;f = \mathsf{focus}\;g$ in the focused sequent calculus, and deciding syntactic equality of focused derivations is straightforward.

%ies, so we can construct an effective procedure to determine equivalence of morphisms in a free skew monoidal closed category.
%Given two parallel morphisms in a category composed exclusively of commutativity of diagrams of canonical morphisms
%Therefore, deciding two proofs to be equivalent could be done by checking whether their corresponding focused derivation are identical.
%Next, we can extend this result to decide equality of morphisms in skew monoidal closed categories.

%We take one more step to extend the results to categorical side.
%According to categorical semantics section above, we know \SkNMILL\ is sound and complete with free skew monoidal categories, so we can construct an effective procedure to determine equivalence of morphisms in a free skew monoidal closed category.
%\begin{enumerate}
%  \item Given two moprhisms $f$ and $g$ in a free skew monoidal closed category.
%  \item Use $\mathsf{complt}$ function to obtain two derivations $\mathsf{complt} \text{ } f$ and $\mathsf{complt} \text{ } g$ in sequent calculus system.
%  \item Apply $\mathsf{complt} \text{ } f$ and $\mathsf{complt} \text{ } g$ to function $\mathsf{focus}$ respectively.
%  \item If $\mathsf{focus} \text{ } (\mathsf{complt} \text{ } f) = \mathsf{focus} \text{ } (\mathsf{complt} \text{ } g)$, then $f \doteq g$, else $f \not\doteq g$.
%\end{enumerate}

%%\begin{theorem}
%%  \begin{enumerate}
%%    \item For any derivation $f : S \mid \Gamma \vdash_{\mathsf{RI}} C$, there is a derivation $\mathsf{emb}$ $f : S \mid \Gamma \vdash C$.
%%    \item For any derivation $f : S \mid \Gamma \vdash C$, there is a derivation $\mathsf{focus}$ $f : S \mid \Gamma \vdash_{\mathsf{RI}} C$.
%%  \end{enumerate}
%%\end{theorem}
%%\begin{theorem}
%%  \begin{enumerate}
%%    \item For any $f : S \mid \Gamma \vdash_{\RI} C$, $\mathsf{focus} \text{ } (\mathsf{emb} \text{ } f) = f$.
%%    \item For any $f, g : S \mid \Gamma \vdash C$,  if $f \circeq g$, then $\mathsf{focus} \text{ } f = \mathsf{focus} \text{ } g$.
%%    \item For any $f : S \mid \Gamma \vdash C$, $\mathsf{emb} \text{ } (\mathsf{focus} \text{ } f) \circeq f$.
%%  \end{enumerate}
%%\end{theorem}
\vspace{-.5cm}
\section{Conclusion}

The paper describes a sequent calculus for \SkNMILL, a skew variant of non-commutative multiplicative intuitionistic linear logic. The introduction of the logic \SkNMILL via this sequent calculus is motivated by the categorical notion of skew monoidal closed category, which yields the intended categorical models for the logic. Sequent calculus derivations admit unique normal forms wrt.\ a congruence relation $\circeq$ capturing the equational theory of skew monoidal closed categories at the level of derivations. Normal forms can be organized in a focused sequent calculus, where each focused derivation uniquely corresponds to (and so represents) a $\circeq$-equivalence class in the unfocused sequent calculus. In order to deal with all the permutative conversions in $\circeq$, and consequently eliminate the related sources of non-determinism in bottom-up proof search, the focused sequent calculus employs a system of tags for keeping track of the new formulae occurring in the context while building a derivation. The focused sequent calculus solves the coherence problem for skew monoidal closed category: deciding equality of focused derivations is equivalent to deciding the commutativity of canonical diagrams in any skew monoidal closed category.

We plan to investigate alternative presentations of \SkNMILL, such as natural deduction. Analogously to the case of the sequent calculus studied in this paper, we expect natural deduction derivation to be strongly normalizing wrt.\ an appropriately defined $\beta\eta$-conversion. We are interested in directly comparing the resulting $\beta\eta$-long normal forms with the focused derivations of Section \ref{sec:focus}.

The system of tags in focused proofs, used for taming the non-deterministic choices arising in proof search to be able to canonically represent each equivalence class of $\circeq$, appears to be a new idea. %In the literature,
There exist other techniques for drastically reduce non-determinism in proof search, such as multi-focusing \cite{chaudhuri:canonical:2008} and saturated focusing \cite{scherer:simple:2015}, and we wonder if our system of tags is in any way related to these. % other techniques.

This paper represents the latest installment of a large project aiming at the development of the proof theory of categories with skew structure. So far the project, promoted and advanced by Uustalu, Veltri and Zeilberger, has investigated proof systems for skew semigroup categories \cite{zeilberger:semiassociative:19}, (symmetric and non-symmetric) skew monoidal categories \cite{uustalu:sequent:2021,uustalu:proof:nodate,veltri:coherence:2021} and skew prounital closed categories \cite{uustalu:deductive:nodate}. From a purely proof-theoretic perspective, the main incentive gained from the study of these skew systems is a \emph{modular} understanding of Andreoli's focusing technique. This is particularly highlighted in Uustalu et al.'s study of \emph{partially normal} skew monoidal categories \cite{uustalu:proof:nodate}, where one or more structural laws among $\lambda$, $\rho$ and $\alpha$ can be required to be invertible. The focused sequent calculus of partially normal skew monoidal categories is obtained from the focused sequent calculus of skew monoidal categories by modularly adding new rules for each enforced normality condition.
We expect a similar modular behaviour to show up in the case of partially normal skew monoidal closed categories.

We are also planning to develop an extension of \SkNMILL\ with an exponential modality $!$. This in turns requires the study of linear exponential comonads on skew monoidal closed categories, extending the work of Hasegawa \cite{hasegawa:linear:2017}. Modalities for exchange \cite{jiang:lambek:2019} and associativity/unitality will also be considered.

\paragraph{Acknowledgements} N.V.\ and T.U.\ were supported by the
Estonian Research Council grants no.~PSG659, PSG749 and PRG1210, N.V.\ and
C.-S.W.\ by the ESF funded Estonian IT Academy research measure
(project 2014-2020.4.05.19-0001). T.U.\ was supported by the Icelandic
Research Fund grant no.~196323-053.

  \bibliographystyle{eptcs}
  \bibliography{ncl22-revised}
\end{document}
